/* core_deviceDatabase4 8.21.0 2018-01-30T22:08:26+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";angular.module("c8y.deviceDatabase4",[]).constant("deviceDatabasePath","core_deviceDatabase4")}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c){function u(){d(),m().then(p)}function d(){i.changeTitle({title:o("Device database")})}function m(){return a.getAvailableDeviceTypes()}function p(t){e.deviceTypes||(e.deviceTypes=[]),_.forEach(t,function(t){e.deviceTypes.push(t)}),e.paging=t.paging||{refresh:!0}}function g(){e.deviceTypes=null,e.refreshLoading=!0,m().then(p).finally(function(){e.refreshLoading=!1})}function v(){e.paging.loading=!0,m().finally(function(){e.paging.loading=!1})}function f(e){var n=e&&e.id||"new";t.path("/device-types/"+n)}function y(){f()}function b(){a.importDeviceTypeWithUI().then(h,T)}function h(){r.success(o("New device type imported!")),g()}function T(e){_.isObjectLike(e)&&(e.errorMessage?r.danger(c.getString('Could not import device type due to: "{{errorMessage}}"!',{errorMessage:l.getTranslatedServerMessage(e.errorMessage)})):r.danger(o("Could not import device type!")))}function I(e){return a.exportDeviceTypeAndSaveAs(e)}function D(t){s({title:o("Confirm delete?"),body:c.getString('Do you really want to remove device type "{{name}}"? Connected devices of this type will become unavailable.',t),status:"danger"}).then(_.partial(n.remove,t)).then(_.partial(_.pull,e.deviceTypes,t)).then(function(){r.success(o("Device type successfully removed!"))})}e.refresh=g,e.loadNext=v,e.navigateToDetails=f,e.addDeviceType=y,e.importDeviceType=b,e.onClickExport=I,e.onClickDelete=D,u()}e.$inject=["$scope","$location","c8yInventory","c8yDeviceDatabase","c8yTitle","c8yModal","c8yAlert","c8yLocales","gettext","gettextCatalog"],angular.module("c8y.deviceDatabase4").controller("deviceTypesListCtrl",e)}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c,u,d){function m(){return"new"===k}function p(){return g(),v(k).then(b).then(h)}function g(){e.deviceTypesFeatures=r.getDeviceTypesFeatures()}function v(e){return f(e).then(y)}function f(e){return n.when(m()?r.getEmptyDeviceType():r.getDeviceType(e))}function y(t){e.deviceType=t,e.formValue={fieldbusType:t.fieldbusType},e.features=_.find(e.deviceTypesFeatures,{fieldbusType:t.fieldbusType})}function b(){e.discreteOutputsCategorized=r.getDiscreteOutputsCategorized(e.deviceType),e.discreteInputsCategorized=r.getDiscreteInputsCategorized(e.deviceType),e.holdingRegistersCategorized=r.getHoldingRegistersCategorized(e.deviceType),e.inputRegistersCategorized=r.getInputRegistersCategorized(e.deviceType)}function h(){l.changeTitle({title:e.deviceType.name||u("New device type")})}function T(t){return w(t,r.getEmptyDiscreteOutput(),e.deviceType.c8y_Coils)}function I(t){return w(t,r.getEmptyDiscreteInput(),e.deviceType.c8y_Coils)}function D(t){return R(t,r.getEmptyHoldingRegister(e.deviceType),e.deviceType.c8y_Registers)}function S(t){return R(t,r.getEmptyInputRegister(),e.deviceType.c8y_Registers)}function w(e,t,n){return M("DiscreteIO",e,t,n)}function R(e,t,n){return M("Register",e,t,n)}function M(t,n,a,i){var s="edit"+t+"WithUI";return r[s](n||a,e.deviceType).then(_.partial(E,n,i)).then(b)}function E(t,n,a){if(_.get(e.features,"holdingRegisters.number.useHex",!1)&&!a.number.startsWith("0x")&&(a.number="0x"+a.number),t){var i=_.indexOf(n,t);n.splice(i,1,a)}else n.push(a)}function x(t){var n=u('Do you really want to remove coil "{{name}}"?');return O(t,e.deviceType.c8y_Coils,n)}function A(t){var n=u('Do you really want to remove discrete input "{{name}}"?');return O(t,e.deviceType.c8y_Coils,n)}function C(t){var n=u('Do you really want to remove holding register "{{name}}"?');return O(t,e.deviceType.c8y_Registers,n)}function V(t){var n=u('Do you really want to remove input register "{{name}}"?');return O(t,e.deviceType.c8y_Registers,n)}function O(e,t,n){return o({title:u("Confirm delete?"),body:d.getString(n,e),labels:{ok:u("Delete")},status:"danger"}).then(angular.bind(s,s.removeFromList,t,e)).then(b)}function N(e){return r.save(e).then(function(){c.success(u("Device type saved successfully!")),U=!0}).then(angular.bind(i,i.path,"/device-types"))}function B(){e.deviceType.fieldbusType?o({title:u("Confirm device type change?"),body:d.getString("By changing device type, all changes will be lost. Do you really want to proceed?")}).then(function(){return r.removeAllElements(e.deviceType),b(),e.deviceType.fieldbusType=e.formValue.fieldbusType,e.deviceType.fieldbusType},function(){return e.formValue.fieldbusType=e.deviceType.fieldbusType,e.formValue.fieldbusType}).then(function(t){e.features=_.find(e.deviceTypesFeatures,{fieldbusType:t})}):(e.deviceType.fieldbusType=e.formValue.fieldbusType,e.features=_.find(e.deviceTypesFeatures,{fieldbusType:e.deviceType.fieldbusType}))}function $(){var t=e.deviceType,n=e.deviceTypeForm;return n.$invalid||!t||0===t.c8y_Coils.length&&0===t.c8y_Registers.length}var k=t.deviceTypeId,U=!0;e.messageIdSources=r.MESSAGE_ID_SOURCES,e.addDiscreteOutput=e.editDiscreteOutput=T,e.addDiscreteInput=e.editDiscreteInput=I,e.addHoldingRegister=e.editHoldingRegister=D,e.addInputRegister=e.editInputRegister=S,e.removeDiscreteOutput=x,e.removeDiscreteInput=A,e.removeHoldingRegister=C,e.removeInputRegister=V,e.isEmpty=_.isEmpty,e.isNew=m,e.save=N,e.saveDisabled=$,e.changeDeviceType=B,e.$watch("deviceType",function(e,t){t&&!_.eq(e,t)&&(U=!1)},!0),e.$on("$locationChangeStart",function(e,t){if(!U)return e.preventDefault(),o({title:u("Changes not saved"),body:u("Do you want to leave this page and discard the changes made?"),status:"warning",labels:{ok:u("Yes"),cancel:u("No")}}).then(function(){U=!0,a.location.href=t})}),p()}e.$inject=["$scope","$routeParams","$q","$window","$location","c8yBase","c8yDeviceDatabase","c8yTitle","c8yModal","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.deviceDatabase4").controller("deviceTypeDetailsCtrl",e)}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c,u){function d(){m(),p()}function m(){e.element=i.addDiscreteIOMeta(l)}function p(){e.categories=c}function g(){e.element.meta.updateStatus&&(e.element.meta.showStatus=!0)}function v(t){return f(),y(),a.invalid(e.forms,I,t)}function f(){var t=e.forms[I].name,n=e.element&&e.element.meta,a=!(!_.isUndefined(t.$modelValue)&&_.some(o,function(e){return(!n||n.original&&n.original.name!==e.name)&&e.name===t.$modelValue}));t.$setValidity(D.IS_VALID_NAME,a)}function y(){var t=e.forms[I].number,n=e.element&&e.element.meta,a=!(!_.isUndefined(t.$modelValue)&&_.some(o,function(a){return(!n||n.original&&n.original.number!==a.number)&&a.input===e.element.input&&a.number===t.$modelValue}));t.$setValidity(D.IS_VALID_NUMBER,a)}function b(e){return a.validationHints(e,S)}function h(){e.element&&(e.element.meta=e.element.meta||{},e.element.meta.showStatus?e.element.meta.enumValues||(e.element.meta.enumType=!0,e.element.meta.enumValues=_.cloneDeep(i.MetaDefaults.discreteIO.enumValues)):(e.element.meta.enumType=!1,e.element.meta.enumValues=void 0))}function T(){t.close(i.removeDiscreteIOMeta(e.element))}e.forms={};var I="element",D={IS_REQUIRED:"required",IS_VALID_NAME:"valid-name",IS_VALID_NUMBER:"valid-number"},S={};S[D.IS_REQUIRED]=r("This field is required!"),S[D.IS_VALID_NAME]=r("Name should be unique among coils and discrete inputs!"),S[D.IS_VALID_NUMBER]=r(l.input?"Number should be unique among discrete inputs!":"Number should be unique among coils!"),e.features=u[l.input?"discreteInputs":"discreteOutputs"],e.onUpdateStatusCheckboxClicked=g,e.alarmSeverities=s.severityList,e.invalid=v,e.validationHints=b,e.save=T,e.dismiss=t.dismiss,e.$watch("element.meta.showStatus",h),d()}e.$inject=["$scope","$uibModalInstance","$q","c8yBase","c8yDeviceDatabase","c8yAlarms","gettext","element","existingElements","existingCategories","features"],angular.module("c8y.deviceDatabase4").controller("discreteIOModalCtrl",e)}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c,u,d,m,p){function g(){v(),f()}function v(){e.element=i.addRegisterMeta(o)}function f(){e.categories=u}function y(){e.element.meta.updateStatus&&(e.element.meta.showStatus=!0)}function b(){var t=O(e.element.startBit);e.element.noBits>t&&(e.element.noBits=t)}function h(){e.element.meta.valuesRange=i.getValuesRange(e.element)}function T(e){var t=l.getString("no value");return _.isUndefined(e)||_.isNaN(e)||(t=e),["(",t,")"].join("")}function I(t){return D(t),S(t),w(),R(),M(),E(),a.invalid(e,B,t)}function D(t){if("number"===t&&_.get(N,"number.useHex")){var n=e[B].number,a=n.$modelValue;if(!a)return void n.$setValidity($.IS_VALID_MESSAGEID,!0);a.startsWith("0x")&&(a=a.substring(2));var i=parseInt(a,16),s=i.toString(16)===a.toLowerCase();n.$setValidity($.IS_VALID_MESSAGEID,s),n.$setValidity($.IS_MIN,!s||i>=0),n.$setValidity($.IS_MAX,!s||i<=268435455)}}function S(t){if("browsePath"===t){var n=e[B].browsePath.$viewValue,a=/^|((\d)+:[^\/]+)([\/](\d)+:[^\/]+)*$/;e[B].browsePath.$setValidity($.IS_VALID_BROWSEPATH,a.test(n))}}function w(){var t=e[B].name,n=e.element&&e.element.meta,a=!(!_.isUndefined(t.$modelValue)&&_.some(c,function(e){return(!n||n.original.name!==e.name)&&e.name===t.$modelValue}));t.$setValidity($.IS_VALID_NAME,a)}function R(){var t=e[B].number,n=e[B].startBit,a=e[B].noBits,s=e.element&&e.element.meta,r=!(t&&!_.isUndefined(t.$modelValue)&&!_.isUndefined(n.$modelValue)&&!_.isUndefined(a.$modelValue)&&_.some(c,function(r){var l=t.$modelValue;return _.get(N,"number.useHex")&&l&&l.indexOf("0x")===-1&&(l="0x"+l),(!s||!(s.original&&s.original.number===r.number&&s.original.startBit===r.startBit))&&r.input===e.element.input&&r.number===l&&(r.startBit===n.$modelValue&&r.noBits===a.$modelValue||i.areOverlappingRegisters(r,{startBit:n.$modelValue,noBits:a.$modelValue}))}));t&&t.$setValidity($.IS_VALID_BIT_RANGE,r),n&&n.$setValidity($.IS_VALID_BIT_RANGE,r),a&&a.$setValidity($.IS_VALID_BIT_RANGE,r)}function M(){var t=e[B].messageTypeId,n=_.get(t,"$modelValue"),a=e[B].measurementType,i=_.get(a,"$modelValue"),s=e[B].measurementSeries,r=_.get(s,"$modelValue"),l=_.get(e,"element.meta"),o=_.get(l,"sendMeasurement"),u=o&&!_.isUndefined(i)&&!_.isUndefined(r),d=_.some(c,function(t){var a=!1,s=_.get(e,"element.id")===_.get(t,"id"),o=N.number&&_.get(l,"original.number")===t.number&&_.get(l,"original.startBit")===t.startBit&&_.get(l,"original.input")===t.input;return s||o||(a=(!N.messageTypeId||_.get(t,"messageTypeId")===n)&&_.get(t,"measurementMapping.type")===i&&_.get(t,"measurementMapping.series")===r),a}),m=!u||!d;a.$setValidity($.IS_VALID_MEASUREMENT,m),s.$setValidity($.IS_VALID_MEASUREMENT,m)}function E(){var t=e[B].noBits;if(t){var n=!e.element.signed||e.element.signed&&!_.isUndefined(t.$modelValue)&&t.$modelValue>1;t.$setValidity($.IS_VALID_NO_BITS_FOR_SIGNED_REGISTER,n)}}function x(e,t){var n=_.cloneDeep(k);return t&&t.validateValueInRegisterRange&&(n[$.IS_VALUE_IN_REGISTER_RANGE]=l.getString(U,t.validateValueInRegisterRange)),a.validationHints(e,n)}function A(){t.close(i.removeRegisterMeta(e.element))}function C(){var t,n=_.get(e.deviceType,"c8y_MessageIdConfiguration.source")===i.MESSAGE_ID_SOURCES.PAYLOAD.value;if(n){var a=_.get(e.deviceType,"c8y_MessageIdConfiguration.messageIdMapping.noBits");t=Math.pow(2,a)-1}return t}function V(){return _.get(e.features,"startBit.max")}function O(t){var n=_.get(e.features,"noBits.max");return _.isNumber(n)&&_.isNumber(t)&&(n-=t),n}var N=p[o.input?"inputRegisters":"holdingRegisters"],B="form_element",$={IS_REQUIRED:"required",IS_VALID_NAME:"valid-name",IS_VALID_BIT_RANGE:"valid-bit-range",IS_VALID_MEASUREMENT:"valid-measurement",IS_VALUE_IN_REGISTER_RANGE:"value-in-register-range",IS_VALID_NO_BITS_FOR_SIGNED_REGISTER:"no-bits-for-signed-register",IS_VALID_MESSAGEID:"valid-messageID",IS_VALID_BROWSEPATH:"valid-browsePath",IS_MIN:"min",IS_MAX:"max",IS_UNIQUE:"unique",PATTERN:"pattern"},k={};k[$.IS_REQUIRED]=r("This field is required!"),k[$.IS_VALID_NAME]=_.get(N,"validation.invalidName",r("Name should be unique among registers!")),k[$.IS_VALID_BIT_RANGE]=r("Chosen number, start bit or number of bits overlap with another register!"),k[$.IS_VALID_MEASUREMENT]=_.get(N,"validation.invalidMeasurement",r("Chosen measurement type and series are already used by another register!")),k[$.IS_MIN]=r("Value cannot be lower than minimum!"),k[$.IS_MAX]=r("Value cannot be greater than maximum!"),k[$.IS_UNIQUE]=r("Value cannot be used more than once!"),k[$.IS_VALID_NO_BITS_FOR_SIGNED_REGISTER]=r("At least two bits needed for signed register!"),k[$.IS_VALID_MESSAGEID]=r("Invalid hexadecimal number!"),k[$.IS_VALID_BROWSEPATH]=r("Invalid browse path!"),k[$.PATTERN]=r("Dots not allowed.");var U=r("Value out of range! Allowed values from {{min | number}} to {{max | number}} with step {{step | number}}. Use up/down arrows to find nearest possible value.");e.PATTERN_VALIDATE_FRAGMENT_SERIES="^[^.]*$",_.assign(e,{alarmSeverities:s.severityList,getValuePlaceholder:T,addEnumValue:i.addEmptyEnumValue,removeEnumValue:i.removeEnumValue,invalid:I,validationHints:x,onUpdateStatusCheckboxClicked:y,save:A,dismiss:t.dismiss,deviceType:d,fieldbusType:m,messageTypeIdMax:C,startBitMax:V,noBitsMax:O,features:N}),e.$watch("element.startBit",b),e.$watch("element.min",h),e.$watch("element.max",h),e.$watch("element.noBits",h),e.$watch("element.multiplier",h),e.$watch("element.divisor",h),e.$watch("element.decimalPlaces",h),e.$watch("element.signed",h),g()}e.$inject=["$scope","$uibModalInstance","$q","c8yBase","c8yDeviceDatabase","c8yAlarms","gettext","gettextCatalog","element","existingElements","existingCategories","deviceType","fieldbusType","features"],angular.module("c8y.deviceDatabase4").controller("registerModalCtrl",e)}(),function(){"use strict";function e(e,t,n,a,i){function s(){r().then(l)}function r(){return n.getPredefinedDeviceTypeInfos()}function l(e){_.forEach(e,function(e){T.push(e)})}function o(e){return n.downloadPredefinedDeviceTypeAndSaveAs(e.id)}function c(e){return p(),n.getPredefinedDeviceType(e.id).then(_.partial(m,e)).then(_.partial(v,e.name,e.fieldbusType))}function u(t){if(t.length){var n=new FileReader;n.onload=function(n){e.$apply(function(){try{var e=JSON.parse(n.target.result),s=e.c8y_ModbusDeviceTypeInfo,r=s&&s.name;d(),g(t[0],e),v(r,s.fieldbusType)}catch(e){p(),a.danger(i("Cannot load device type from selected file!"))}})},n.readAsText(t[0])}}function d(){I.predefined.info=null,I.predefined.deviceType=null}function m(e,t){I.predefined.info=e,I.predefined.deviceType=t}function p(){I.custom.file=null,I.custom.deviceType=null}function g(e,t){I.custom.file=e,I.custom.deviceType=t}function v(e,t){I.newName.edited||(I.newName.value=e),I.fieldbusType=t}function f(e){return I.predefined.info===e}function y(){I.newName.edited=!0}function b(){var e=_.cloneDeep(I.predefined.deviceType||I.custom.deviceType);e.name=I.newName.value,e.fieldbusType=I.fieldbusType,t.close(e)}function h(e){var t=h._cache=h._cache||{},a=t[e.id];return a||(a=t[e.id]=n.downloadPredefinedDeviceTypeHref(e).then(function(n){t[e.id]=n})),a.then?"":a}var T=[],I={predefined:{info:null,deviceType:null},custom:{file:null,deviceType:null},newName:{value:null,edited:!1}};e.selection=I,e.predefinedDeviceTypeInfos=T,e.downloadPredefinedDeviceType=o,e.onPredefinedDeviceTypeInfoSelected=c,e.isPredefinedDeviceTypeInfoSelected=f,e.onCustomDeviceTypeFileSelected=u,e.onNewNameEdited=y,e.import=b,e.cancel=t.dismiss,e.downloadFileName=n.predefinedDeviceTypeHrefFilename,e.downloadFileHref=h,s()}angular.module("c8y.deviceDatabase4").controller("deviceTypeImportCtrl",["$scope","$uibModalInstance","c8yDeviceDatabase","c8yAlert","gettext",e])}(),function(){"use strict";function e(e,t,n){this.humanize=t("humanize2"),this.selectSingle=e.selectSingle;var a=e.device,i=n.generatePaths(a);this.properties=_.map(i,n.createProperty)}angular.module("c8y.deviceDatabase4").controller("FieldbusPropertySelectorCtrl",["modalParams","$filter","fieldbusPropertyGenerator",e]),e.prototype.isParent=function(e){return 1===e.keyPath.length},e.prototype.orderByFn=function(e){return e.keyPath.join(".")}}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c){function u(){return Gt}function d(e){return _.find(Gt,{fieldbusType:Ct(e)})}function m(e,t){var n,a=_.get(e,"meta.type"),i=_.get(e,"input"),s=d(t);return a&&(a===Ut.DISCRETE_IO?n=o(i?"Discrete input":"Coil (discrete output)"):a===Ut.REGISTER&&(n=i?o("Input register"):_.get(s,"holdingRegisters.elementTypeLabel",o("Holding register")))),n}function p(){return _.cloneDeep(_.assign({},Ht.common,Ht.deviceType))}function g(){return _.cloneDeep(_.assign({},Ht.common,Ht.element,Ht.discreteIO,Ht.discreteOutput))}function v(){return _.cloneDeep(_.assign({},Ht.common,Ht.element,Ht.discreteIO,Ht.discreteInput))}function f(e){var t=null;return t="canbus"===e.fieldbusType?_.cloneDeep(_.assign({},Ht.common,Ht.element,Ht.register,Ht.canbusRegister,Ht.holdingRegister)):_.cloneDeep(_.assign({},Ht.common,Ht.element,Ht.register,Ht.holdingRegister))}function y(){return _.cloneDeep(_.assign({},Ht.common,Ht.element,Ht.register,Ht.inputRegister))}function b(e){var t=!0,n={},a={__and:[{__or:[{__has:Ft},{type:Pt}]}]};return e&&a.__and.push(e),i.listQuery(a,n,t).then(function(e){return _.map(e,Ee)})}function h(t){var n=e.when(null),a=_.at(t,kt),i=_.find(a),s=/\/inventory\/managedObjects\/(\d+)/.exec(i),r=s&&s[1];return r&&(n=T(r)),n}function T(e){return i.detail(e).then(a.getResData).then(Ee)}function I(){return l({templateUrl:"core_deviceDatabase4/views/deviceTypeImport.html",controller:"deviceTypeImportCtrl"}).then(N)}function D(){return window.c8y&&window.c8y.collections&&window.c8y.collections.devicetypes}function S(){var t=D();return t&&e.when(_.map(t))}function w(){var e=[qt,"index.json"].join("/");return(S()||t.get(e).then(a.getResData)).then(x)}function R(t){var n=(D()||{})[t],a=n&&_.clone(n._item);return a&&e.when(a)}function M(e){var n=[qt,e+".json"].join("/");return R(e)||t.get(n).then(a.getResData)}function E(e){var n=e+".json",a=[qt,n].join("/");return t.get(a).then(function(e){var t=JSON.stringify(e.data,null,2),a=e.headers("Content-Type"),i=new Blob([t],{type:a});saveAs(i,n)})}function x(e){return _.filter(e,function(e){return $t>=e.minFieldbusUI})}function A(e){var t=e.name+".json",n="application/json",a=JSON.stringify(C(e),null,2),i=new Blob([a],{type:n});saveAs(i,t)}function C(e){return e.c8y_ModbusDeviceTypeInfo=V(e),e.c8y_Coils=_.map(e.c8y_Coils,O),e.c8y_Registers=_.map(e.c8y_Registers,O),_.pick(e,["c8y_ModbusDeviceTypeInfo","c8y_Coils","c8y_Registers","c8y_useServerTime","c8y_MessageIdConfiguration"])}function V(e){var t=e.c8y_ModbusDeviceTypeInfo||{};return _.assign(t,{name:e.name,minFieldbusUI:$t,fieldbusType:e.fieldbusType}),_.omit(t,["id","category","description"])}function O(e){return e.eventMapping&&(e.eventMapping=_.omit(e.eventMapping,["eventTemplate"])),e.alarmMapping&&(e.alarmMapping=_.omit(e.alarmMapping,["raiseAlarmTemplate"])),e.measurementMapping&&(e.measurementMapping=_.omit(e.measurementMapping,["sendMeasurementTemplate"])),_.omit(e,["id","originalName","originalNumber","originalStartBit","meta"])}function N(t){var n,s;return n=e.when(t).then($).then(k).then(U).then(F).then(Y).then(X).then(ee),s=t.id?n.then(i.save):n.then(i.createConfirm).then(a.getResData).then(B)}function B(t){return r.createIdentity(t,{type:"c8y_SmartRestDeviceIdentifier",externalId:t.name},{silentError:!0}).catch(function(n){var a=_.bind(e.reject,e,{errorMessage:n.data.message});return i.remove(t).then(a,a)})}function $(e){if(!e.type){var t=d(e);e.type=_.get(t,"type",Pt)}return e}function k(e){return _.set(e,[Ft],{})}function k(e){return e[Ft]={},e}function U(e){return"canbus"===e.fieldbusType&&(e.c8y_useServerTime=!0),e}function F(t){return t.c8y_Coils=_.map(t.c8y_Coils,P),t.c8y_Registers=_.map(t.c8y_Registers,P),e.when(t)}function P(e){return e.id||(e.id=String(Math.random()).substr(2)),e}function q(e){var t=_.compact(j(e));return _.first(t)}function j(e){return[H(e),L(e),G(e),z(e)]}function H(e){return _.get(e,"id")}function L(e){return W(e,["input","number","startBit"])}function G(e){return W(e,["input","number"])}function z(e){return W(e,["number"])}function W(e,t){var n,a=_.map(t,_.propertyOf(e)),i=_.every(a,_.negate(_.isUndefined));return i&&(n=a.join(",")),n}function J(e,t,n){var a=_(e).map(function(e){return{score:Q(e,t,n),element:e}}).reject(function(e){return _.isUndefined(e.score)}).orderBy("score",["asc"]).first();return _.get(a,"element")}function Q(e,t,n){var a=e.meta.type.value===n,i=j(e),s=_.findIndex(i,_.negate(_.isUndefined)),r=_.indexOf(i,t);return a&&r>=0?s-r:void 0}function Y(e){return e.c8y_Coils=_(e.c8y_Coils).sortBy("number").sortBy("input").value(),e.c8y_Registers=_(e.c8y_Registers).sortBy("startBit").sortBy("number").sortBy("input").value(),e}function X(e){var t=d(e),n=_.get(t,"configuration.messageIdConfiguration");return n&&(e.c8y_MessageTypes=K(e)),e}function K(e){var t=["c8y_Registers","c8y_Coils"];return _.reduce(t,function(t,n){return _.merge(t,Z(e,n))},{})}function Z(e,t){var n=_.groupBy(e[t],"messageTypeId"),a=_.mapValues(n,function(n){return _.map(n,function(n){return _.indexOf(e[t],n)})});return _.reduce(a,function(e,n,a){return e[a]={},e[a][t]=n,e},{})}function ee(e){return e.com_cumulocity_model_smartrest_SmartRestTemplate=te(e),e}function te(e){var t=[],n=[];return t.push(ne(e)),t.push(ae(e)),t.push(re(e)),t.push(oe(e)),n.push(_e(e)),n.push(Te(e)),n.push(Ie(e)),n.push(De(e)),{requestTemplates:_.flattenDeep(t),responseTemplates:_.flattenDeep(n)}}function ne(e){return{msgId:100,method:"PUT",contentType:"application/vnd.com.nsn.cumulocity.managedObject+json",placeholder:jt,resourceUri:"/inventory/managedObjects/"+jt,templateString:we([{key:"c8y_CoilStatus",value:new Se(ie(e.c8y_Coils).map(function(e){return{key:e.name,value:jt,raw:!0}}).value())}]),values:["UNSIGNED"].concat(ie(e.c8y_Coils).map(function(){return"UNSIGNED"}).value())}}function ae(e){return{msgId:101,method:"PUT",contentType:"application/vnd.com.nsn.cumulocity.managedObject+json",placeholder:jt,resourceUri:"/inventory/managedObjects/"+jt,templateString:we([{key:"c8y_RegisterStatus",value:new Se(ie(e.c8y_Registers).map(function(e){return{key:e.name,value:jt,raw:!0}}).value())}]),values:["UNSIGNED"].concat(ie(e.c8y_Registers).map(function(){return"NUMBER"}).value())}}function ie(e){return _(e).filter(se)}function se(e){return e.statusMapping&&e.statusMapping.status}function re(e){var t=[];return t.push(le(102,"EXECUTING")),t.push(le(103,"SUCCESSFUL")),t.push(le(104,"FAILED")),t}function le(e,t){return{msgId:e,method:"PUT",contentType:"application/vnd.com.nsn.cumulocity.operation+json",placeholder:jt,resourceUri:"/devicecontrol/operations/"+jt,templateString:we({status:t}),values:["UNSIGNED"]}}function oe(e){var t,n,a,i=[],s=300;return t=ce(s,e),i.push(t.tpls),n=pe(t.msgId,e),i.push(n.tpls),a=be(n.msgId,e),i.push(a.tpls),i}function ce(e,t){var n=[],a=_.filter(t.c8y_Coils,"alarmMapping"),i=_.filter(t.c8y_Registers,"alarmMapping");return _.forEach(a,function(a){n.push(me(e,t,a.alarmMapping,ue(a))),a.alarmMapping.raiseAlarmTemplate=e++}),_.forEach(i,function(a){n.push(me(e,t,a.alarmMapping,de(a))),a.alarmMapping.raiseAlarmTemplate=e++}),{msgId:e,tpls:n}}function ue(e){return{c8y_ModbusSource:{coil:_.pick(e,"input","number")}}}function de(e){return{c8y_ModbusSource:{register:_.pick(e,["input","number","startBit","noBits"])}}}function me(e,t,n,a){return{msgId:e,method:"POST",contentType:"application/vnd.com.nsn.cumulocity.alarm+json",accept:"application/vnd.com.nsn.cumulocity.alarm+json",placeholder:jt,resourceUri:"/alarm/alarms",templateString:we([{key:"source",value:{id:jt}},{key:"type",value:n.type},{key:"status",value:s.status.ACTIVE},{key:"severity",value:n.severity},{key:"time",value:jt},{key:"text",value:n.text},{key:"c8y_ModbusSource",value:a.c8y_ModbusSource}]),values:["UNSIGNED",ye(t)]}}function pe(e,t){var n=[],a=[].concat(t.c8y_Coils).concat(t.c8y_Registers),i=_(a).filter("measurementMapping").groupBy(ge).value();return _.forEach(i,function(a,i){var s=_.map(a,ve);n.push(fe(e,t,i,s)),_.forEach(s,function(t){t.sendMeasurementTemplate=e,delete t.unit}),e++}),{msgId:e,tpls:n}}function ge(e){return e.measurementMapping.type}function ve(e){return e.measurementMapping.unit=e.unit||e.measurementMapping.unit,e.measurementMapping}function fe(e,t,n,a){return{msgId:e,method:"POST",contentType:"application/vnd.com.nsn.cumulocity.measurement+json",placeholder:jt,resourceUri:"/measurement/measurements",templateString:we(function(){var e=n,t={source:{id:jt},time:jt,type:e};return t[e]={},_.forEach(a,function(n){t[e][n.series]={value:"%n",unit:n.unit}}),t}()),values:["UNSIGNED",ye(t)].concat(_.map(a,function(e){return"NUMBER"}))}}function ye(e){var t="DATE";return e.c8y_useServerTime&&(t="NOW"),t}function be(e,t){var n=[],a=[].concat(t.c8y_Coils).concat(t.c8y_Registers);return _.forEach(a,function(a){_.isUndefined(a.eventMapping)||(n.push(he(e,t,a,a.eventMapping)),a.eventMapping.eventTemplate=e++)}),{msgId:e,tpls:n}}function he(e,t,n,a){return{msgId:e,method:"POST",contentType:"application/vnd.com.nsn.cumulocity.event+json",placeholder:jt,resourceUri:"/event/events",templateString:we([{key:"source",value:{id:jt}},{key:"time",value:jt},{key:"type",value:a.type},{key:"text",value:a.text},{key:n.name,value:jt}]),values:["UNSIGNED",ye(t),"STRING"]}}function _e(e){return{msgId:200,condition:"$.c8y_SetCoil",pattern:["$.id","$.c8y_SetCoil.address","$.c8y_SetCoil.input","$.c8y_SetCoil.coil","$.c8y_SetCoil.value"]}}function Te(e){return{msgId:201,condition:"$.c8y_SetRegister",pattern:["$.id","$.c8y_SetRegister.ipAddress","$.c8y_SetRegister.address","$.c8y_SetRegister.input","$.c8y_SetRegister.register","$.c8y_SetRegister.startBit","$.c8y_SetRegister.noBits","$.c8y_SetRegister.value"]}}function Ie(e){return{msgId:202,condition:"$.c8y_ModbusDevice",pattern:["$.id","$.deviceId","$.c8y_ModbusDevice.id","$.c8y_ModbusDevice.address","$.c8y_ModbusDevice.type","$.c8y_ModbusDevice.protocol"]}}function De(e){return{msgId:203,condition:"$.c8y_ModbusSource",pattern:["$.id"]}}function Se(e){this.kvObj=e}function we(e,t){var n;return e instanceof Se?n=Re(e.kvObj):_.isArray(e)?n=Re(e):_.isObjectLike(e)&&(n=angular.toJson(e)),t=t||jt,n=n.replace(/"%n"/g,t)}function Re(e){var t=_.map(e,Me);return"{"+t.join(",")+"}"}function Me(e){var t,n={};return e.value instanceof Se?(n[e.key]=":::INNER_OBJECT_STRING:::",t=angular.toJson(n).replace('":::INNER_OBJECT_STRING:::"',Re(e.value.kvObj)),t=t.substr(1,t.length-2)):e.raw?(n[e.key]=":::RAW_VALUE:::",t=angular.toJson(n).replace('":::RAW_VALUE:::"',e.value),t=t.substr(1,t.length-2)):(n[e.key]=e.value,t=angular.toJson(n),t=t.substr(1,t.length-2)),t}function Ee(e){return e=xe(e),e=Ae(e),e.fieldbusType=Ct(e),e=k(e)}function xe(e){return _.forEach(e.c8y_Coils,function(e){!e.enumValues&&e.statusMapping&&_.isArray(e.statusMapping.enumValues)&&(e.enumValues={0:e.statusMapping.enumValues[0],1:e.statusMapping.enumValues[1]},delete e.statusMapping.enumValues),_.isUndefined(e.input)&&(e.input=Ht.discreteOutput.input)}),e}function Ae(e){return _.forEach(e.c8y_Registers,function(e){e.startBit=e.startBit||Ht.register.startBit,e.noBits=e.noBits||Ht.register.noBits,e.signed=e.signed||Ht.register.signed,!e.unit&&e.measurementMapping&&e.measurementMapping.unit&&(e.unit=e.measurementMapping.unit,delete e.measurementMapping.unit),_.isUndefined(e.input)&&(e.input=Ht.holdingRegister.input)}),e}function Ce(e){var t=_.get(e,"c8y_Coils",[]),n=_.get(e,"c8y_Registers",[]);return _.union(_.map(t,Oe),_.map(n,We))}function Ve(e){if(e)return e.c8y_Coils=_.map(e.c8y_Coils,Oe),e}function Oe(e){e.meta=e.meta||{};var t=_.flow([Ne,Be,ke,Ue,Fe]);return t(e)}function Ne(e){return e.meta.type=e.meta.type||Ut.DISCRETE_IO,e}function Be(e){return e.meta.enumType=e.meta.enumType||!!e.enumValues,e.meta.enumValues=e.meta.enumValues||e.enumValues&&_.map(e.enumValues,$e),e}function $e(e,t){return{value:parseFloat(t),label:e}}function ke(e){return e.meta.showStatus=e.meta.showStatus||!(!e.statusMapping||"read"!==e.statusMapping.status&&"write"!==e.statusMapping.status),e.meta.updateStatus=e.meta.updateStatus||!(!e.statusMapping||"write"!==e.statusMapping.status),e}function Ue(e){return e.meta.raiseAlarm=e.meta.raiseAlarm||!(!e.alarmMapping||_.isUndefined(e.alarmMapping.raiseAlarmTemplate)),e}function Fe(e){return e.meta.sendEvent=e.meta.sendEvent||!(!e.eventMapping||_.isUndefined(e.eventMapping.eventTemplate)),e}function Pe(e){return e.meta&&(e=qe(e),e=je(e),e=He(e),e=Le(e),e=Ge(e),delete e.meta),e}function qe(e){return e.meta.type=void 0,e}function je(e){return e.meta.enumType?(e.enumValues={},_.forEach(e.meta.enumValues,function(t){e.enumValues[t.value]=t.label})):e.enumValues=void 0,e}function He(e){return e.meta.showStatus||e.meta.updateStatus?(e.statusMapping=e.statusMapping||{},e.meta.showStatus&&(e.statusMapping.status="read"),e.meta.updateStatus&&(e.statusMapping.status="write")):e.statusMapping=void 0,e}function Le(e){return e.meta.raiseAlarm?(e.alarmMapping=e.alarmMapping||{},e.alarmMapping.raiseAlarmTemplate=null):e.alarmMapping=void 0,e}function Ge(e){return e.meta.sendEvent?(e.eventMapping=e.eventMapping||{},e.eventMapping.eventTemplate=null):e.eventMapping=void 0,e}function ze(e){if(e)return e.c8y_Registers=_.map(e.c8y_Registers,We),e}function We(e){e.meta=e.meta||{};var t=_.flow([Je,Qe,Ye,Xe,Ke,Ze,et,tt]);return t(e)}function Je(e){return e.meta.type=e.meta.type||Ut.REGISTER,e}function Qe(e){return e.meta.enumType=e.meta.enumType||!!e.enumValues,e.meta.enumValues=e.meta.enumValues||e.enumValues&&_.map(e.enumValues,$e),e}function Ye(e){return e.meta.showStatus=e.meta.showStatus||!(!e.statusMapping||"read"!==e.statusMapping.status&&"write"!==e.statusMapping.status),e.meta.updateStatus=e.meta.updateStatus||!(!e.statusMapping||"write"!==e.statusMapping.status),e}function Xe(e){return e.meta.sendMeasurement=e.meta.sendMeasurement||!(!e.measurementMapping||_.isUndefined(e.measurementMapping.sendMeasurementTemplate)),e}function Ke(e){return e.meta.raiseAlarm=e.meta.raiseAlarm||!(!e.alarmMapping||_.isUndefined(e.alarmMapping.raiseAlarmTemplate)),e}function Ze(e){return e.meta.sendEvent=e.meta.sendEvent||!(!e.eventMapping||_.isUndefined(e.eventMapping.eventTemplate)),e}function et(e){return e.meta.sendManagedObjectUpdate=e.meta.sendManagedObjectUpdate||!!e.managedObjectMapping,e}function tt(e){return e.meta.valuesRange=e.meta.valuesRange||Et(e),e}function nt(e){return e.meta&&(e=at(e),e=it(e),e=st(e),e=rt(e),e=lt(e),e=ot(e),e=ct(e),e=ut(e),delete e.meta),e}function at(e){return e.meta.type=void 0,e}function it(e){return e.meta.enumType?(e.enumValues={},_.forEach(e.meta.enumValues,function(t){e.enumValues[t.value]=t.label})):e.enumValues=void 0,e}function st(e){return e.meta.showStatus||e.meta.updateStatus?(e.statusMapping=e.statusMapping||{},e.meta.showStatus&&(e.statusMapping.status="read"),e.meta.updateStatus&&(e.statusMapping.status="write")):e.statusMapping=void 0,e}function rt(e){return e.meta.sendMeasurement?(e.measurementMapping=e.measurementMapping||{},e.measurementMapping.sendMeasurementTemplate=null):e.measurementMapping=void 0,e}function lt(e){return e.meta.raiseAlarm?(e.alarmMapping=e.alarmMapping||{},e.alarmMapping.raiseAlarmTemplate=null):e.alarmMapping=void 0,e}function ot(e){return e.meta.sendEvent?(e.eventMapping=e.eventMapping||{},e.eventMapping.eventTemplate=null):e.eventMapping=void 0,e}function ct(e){return e.meta.sendManagedObjectUpdate?e.managedObjectMapping=e.managedObjectMapping||{}:e.managedObjectMapping=void 0,e}function ct(e){return e.meta.sendManagedObjectUpdate?e.managedObjectMapping=e.managedObjectMapping||{}:e.managedObjectMapping=void 0,e}function ut(e){return e.meta.valuesRange=void 0,e}function dt(e){e.c8y_Registers=[],e.c8y_Coils=[]}function mt(e){return _(e.c8y_Coils).reject("input").groupBy(ft).value()}function pt(e){return _(e.c8y_Coils).filter("input").groupBy(ft).value()}function gt(e){return _(e.c8y_Registers).reject("input").groupBy(ft).value()}function vt(e){return _(e.c8y_Registers).filter("input").groupBy(ft).value()}function ft(e){return e.category||""}function yt(e,t){return l({
templateUrl:"core_deviceDatabase4/views/discreteIOModal.html",controller:"discreteIOModalCtrl",title:bt(e),resolve:Tt(e,t.c8y_Coils,t)})}function bt(e){return e.input?e.name?c.getString('Edit discrete input: "{{name}}"',e):o("New discrete input"):e.name?c.getString('Edit coil: "{{name}}"',e):o("New coil")}function ht(e,t){return l({templateUrl:"core_deviceDatabase4/views/registerModal.html",controller:"registerModalCtrl",title:_t(e,t),resolve:Tt(e,t.c8y_Registers,t)})}function _t(e,t){var n,a=d(t);return n=e.input?e.name?c.getString('Edit input register: "{{name}}"',e):o("New input register"):e.name?c.getString(_.get(a,"holdingRegisters.editRegisterModalTitle",o('Edit holding register: "{{name}}"')),e):_.get(a,"holdingRegisters.newRegisterModalTitle",o("New holding register"))}function Tt(e,t,n){var a={};return a.element=_.partial(_.cloneDeep,It(e)),a.existingElements=_.partial(_.cloneDeep,t),a.existingCategories=_.partial(_.cloneDeep,Dt(n)),a.deviceType=_.partial(_.cloneDeep,n),a.fieldbusType=function(){return Ct(n)},a.features=function(){return d(n)},a}function It(e){if(e)return _.assign({},e,{meta:{original:_.cloneDeep(e)}})}function Dt(e){var t=[].concat(e.c8y_Coils).concat(e.c8y_Registers);return _(t).filter("category").map("category").uniq().map(St).value()}function St(e){return{name:e}}function wt(e){e.meta.enumValues=e.meta.enumValues||[],e.meta.enumValues.push({value:null,label:null})}function Rt(e,t){e.meta.enumValues=_.without(e.meta.enumValues,t)}function Mt(e,t){var n=e.startBit+e.noBits-1,a=t.startBit+t.noBits-1;return Math.max(e.startBit,t.startBit)<=Math.min(n,a)}function Et(e){var t=e.decimalPlaces,n=xt(e.multiplier*Math.pow(10,-e.decimalPlaces)/e.divisor),a=xt((e.signed?-Math.pow(2,e.noBits-1):0)*n),i=xt((e.signed?Math.pow(2,e.noBits-1)-1:Math.pow(2,e.noBits)-1)*n);return{base:{decimalPlaces:t,step:n,min:a,max:i},custom:{decimalPlaces:t,step:n,min:Math.max(a,e.min||a),max:Math.min(i,e.max||i)}}}function xt(e){var t=Math.pow(10,10);return Math.round(e*t)/t}function At(e){return l({templateUrl:"core_deviceDatabase4/views/fieldbusPropertySelector.html",controller:"FieldbusPropertySelectorCtrl as ctrl",resolve:{modalParams:_.constant(_.defaults(e,{}))}})}function Ct(e){return e.fieldbusType||"modbus"}function Vt(e){return e.id+".json"}function Ot(e){return!!_.find(_.at(e,["c8y_ModbusDevice","c8y_CanDevice","c8y_OPCUADevice","c8y_OPCUAGateway"]))}function Nt(e){var t=e.id||e;return M(t).then(Bt)}function Bt(e){return window.btoa(JSON.stringify(e,null,2))}var $t=n.has("FIELDBUS_UI_VERSION")?n.get("FIELDBUS_UI_VERSION"):4,kt=["c8y_ModbusDevice.type","c8y_CanBus.type","c8y_OPCUADevice.type"],Ut=a.createEnum(["DISCRETE_IO","REGISTER"]),Ft="c8y_IsDeviceType",Pt="c8y_ModbusDeviceType",qt=a.dataFilePath("devicetypes"),jt="%%",Ht={common:{name:null,fieldbusType:null},deviceType:{c8y_Coils:[],c8y_Registers:[]},element:{number:null},discreteIO:{},discreteOutput:{input:!1},discreteInput:{input:!0},register:{multiplier:1,divisor:1,offset:0,decimalPlaces:0,startBit:0,noBits:16,unit:"",signed:!1},canbusRegister:{noBits:64,offset:0},holdingRegister:{input:!1},inputRegister:{input:!0}},Lt={discreteIO:{enumValues:[{value:0,label:"0"},{value:1,label:"1"}]}},Gt=[],zt=a.createEnum([{name:"FPORT",label:"FPort"},{name:"PAYLOAD",label:"Payload"}]);return{ElementType:Ut,Defaults:Ht,MetaDefaults:Lt,featuresManifests:Gt,MESSAGE_ID_SOURCES:zt,getElementTypeLabel:m,getDeviceTypesFeatures:u,getDeviceTypeFeatures:d,getEmptyDeviceType:p,getAvailableDeviceTypes:b,getDeviceTypeFromDevice:h,getDeviceType:T,save:N,exportDeviceTypeAndSaveAs:A,importDeviceTypeWithUI:I,getPredefinedDeviceTypeInfos:w,getPredefinedDeviceType:M,downloadPredefinedDeviceTypeAndSaveAs:E,upgradeDeviceType:Ee,getElementsWithMeta:Ce,addDiscreteIOsMeta:Ve,addDiscreteIOMeta:Oe,removeDiscreteIOMeta:Pe,addRegistersMeta:ze,addRegisterMeta:We,removeRegisterMeta:nt,removeAllElements:dt,getElementRefId:q,findElementBestMatchingRefId:J,getDiscreteOutputsCategorized:mt,getDiscreteInputsCategorized:pt,getHoldingRegistersCategorized:gt,getInputRegistersCategorized:vt,getEmptyDiscreteOutput:g,getEmptyDiscreteInput:v,getEmptyHoldingRegister:f,getEmptyInputRegister:y,editDiscreteIOWithUI:yt,editRegisterWithUI:ht,addEmptyEnumValue:wt,removeEnumValue:Rt,areOverlappingRegisters:Mt,getValuesRange:Et,openFieldbusSelector:At,downloadPredefinedDeviceTypeHref:Nt,predefinedDeviceTypeHrefFilename:Vt,isFieldbusDevice:Ot}}e.$inject=["$q","$http","$injector","c8yBase","c8yInventory","c8yAlarms","c8yIdentity","c8yModal","gettext","gettextCatalog"],angular.module("c8y.deviceDatabase4").factory("c8yDeviceDatabase",e)}(),function(){"use strict";function e(e,t,n,a,i,s,r,l,o,c){function u(e,n){var i=d(e,n),s=i.then(a.createConfirm).then(t.getResData),l=s.then(_.partial(a.addChildDevice,e)),o=l.then(function(){return s.then(_.partialRight(m,e.owner)).then(a.save)}),c=o.then(function(){return s.then(_.partial(p,e,n.deviceType)).then(r.create)});return c}function d(e,t){var a={name:t.name,type:t.deviceType.name,c8y_ModbusDevice:{address:t.address,ipAddress:t.ipAddress,type:"/inventory/managedObjects/"+t.deviceType.id,protocol:t.protocol}};return n.current().then(function(e){return a.owner=e.id,a})}function m(e,t){return e.owner=t,e}function p(e,t,n){return{deviceId:e.id,description:c.getString("Added new child device to {{name}} ({{id}})",e),c8y_ModbusDevice:{id:n.id,name:n.name,address:n.c8y_ModbusDevice.address,ipAddress:n.c8y_ModbusDevice.ipAddress,type:"/inventory/managedObjects/"+t.id,protocol:n.c8y_ModbusDevice.protocol}}}function g(e,t){var n=!s.isOpcua(e);return n&&!v(e)&&!(!t.statusMapping||"write"!==t.statusMapping.status)}function v(e){return e.c8y_ModbusReadOnlyDevice}function f(e){return e.changePending}function y(e,t){var n=R[t.meta.type.value];return e&&e[n]&&parseFloat(e[n][t.name])}function b(e,t){var n=y(e,t);return t.meta.enumType&&(n=t.meta.enumValues[n].label),n}function h(t,n,a){if(g(t,n)){var i=T(t,n,a);return n.changePending=!0,S(i).then(function(e){return e.status===r.status.SUCCESSFUL?(w(t,n,a),n.changePending=!1):e.status===r.status.FAILED&&(n.changePending=!1),e})}return e.reject()}function T(e,t,n){var a;return t.meta.type===i.ElementType.DISCRETE_IO?a=I(e,t,n):t.meta.type===i.ElementType.REGISTER&&(a=D(e,t,n)),a}function I(e,t,n){return{deviceId:e.id,description:c.getString("{{name}} status changed to {{label}}",{name:t.name,label:n.label}),c8y_SetCoil:{address:e.c8y_ModbusDevice.address,input:t.input,coil:t.number,value:n.value}}}function D(e,t,n){return{deviceId:e.id,description:c.getString("{{name}} value changed to {{value}}{{unit}}",{name:t.name,value:n.label||n.value,unit:!n.label&&t.unit?" "+t.unit:""}),c8y_SetRegister:{ipAddress:e.c8y_ModbusDevice.ipAddress,address:e.c8y_ModbusDevice.address,input:t.input,register:t.number,startBit:t.startBit,noBits:t.noBits,value:n.value}}}function S(e){return r.createWithNotifications(e).then(function(t){return t.created.then(function(){l.success(c.getString('Operation "{{description | translate}}" has been created!',e))}),t.completed.then(function(t){return t.status===r.status.SUCCESSFUL?l.success(c.getString('Operation "{{description | translate}}" has been completed successfully!',e)):t.status===r.status.FAILED&&(t.failureReason?l.danger(c.getString('Operation "{{description | translate}}" has failed because of reason: "{{failureReason}}"!',t)):l.danger(c.getString('Operation "{{description | translate}}" has failed!',t))),t})})}function w(e,t,n){t.meta.type===i.ElementType.DISCRETE_IO?(e.c8y_CoilStatus=e.c8y_CoilStatus||{},e.c8y_CoilStatus[t.name]=n.value):t.meta.type===i.ElementType.REGISTER&&(e.c8y_RegisterStatus=e.c8y_RegisterStatus||{},e.c8y_RegisterStatus[t.name]=n.value)}var R={};R[i.ElementType.DISCRETE_IO.value]="c8y_CoilStatus",R[i.ElementType.REGISTER.value]="c8y_RegisterStatus";var M={label:o("Modbus"),fieldbusType:"modbus",discreteOutputs:{functionalities:{showStatus:!0,updateStatus:!0}},discreteInputs:{functionalities:{showStatus:!0,updateStatus:!0}},holdingRegisters:{number:!0,startBit:{max:15},noBits:{max:16},multiplier:{min:1,step:1},divisor:!0,decimalPlaces:!0,options:{enumType:!0},functionalities:{showStatus:!0,updateStatus:!0}},inputRegisters:{number:!0,startBit:{max:15},noBits:{max:16},decimalPlaces:!0,options:{enumType:!0},functionalities:{showStatus:!0,updateStatus:!0}},options:{serverTime:!0}};return{FEATURES_MANIFEST:M,create:u,canUpdateElement:g,isElementChangePending:f,getCurrentElementValue:y,getCurrentElementValueFormatted:b,updateElement:h}}function t(e,t){e.featuresManifests.push(t.FEATURES_MANIFEST)}t.$inject=["c8yDeviceDatabase","c8yModbusDevice"],e.$inject=["$q","c8yBase","c8yUser","c8yDevices","c8yDeviceDatabase","c8yOPCUADevice","c8yDeviceControl","c8yAlert","gettext","gettextCatalog"],angular.module("c8y.deviceDatabase4").factory("c8yModbusDevice",e).run(t)}(),function(){"use strict";function e(e,t,n,a,i,s){function r(t,i){var s=l(t,i),r=s.then(n.createConfirm).then(e.getResData),u=r.then(_.partial(n.addChildDevice,t)),d=u.then(function(){return r.then(_.partialRight(o,t.owner)).then(n.save)}),m=d.then(function(){return r.then(_.partial(c,t,i.deviceType)).then(a.create)});return m}function l(e,n){var a={name:e.name+" - "+n.deviceType.name,type:n.deviceType.name,c8y_CanDevice:{type:"/inventory/managedObjects/"+n.deviceType.id}};return t.current().then(function(e){return a.owner=e.id,a})}function o(e,t){return e.owner=t,e}function c(e,t,n){return{deviceId:e.id,description:s.getString("Added new child device to {{name}} ({{id}})",e),c8y_CanDevice:{id:n.id,name:n.name,type:"/inventory/managedObjects/"+t.id}}}var u={label:i("CAN Bus"),fieldbusType:"canbus",options:!1,discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{number:{label:i("Message ID"),useHex:!0},startBit:{max:63},noBits:{max:64},multiplier:{min:1,step:1},divisor:!0,decimalPlaces:!0,offset:{min:Number.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),max:Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,step:1},options:{enumType:!0},functionalities:{showStatus:!0,updateStatus:!0}},inputRegisters:!1};return{FEATURES_MANIFEST:u,create:r}}function t(e,t){e.featuresManifests.push(t.FEATURES_MANIFEST)}e.$inject=["c8yBase","c8yUser","c8yDevices","c8yDeviceControl","gettext","gettextCatalog"],t.$inject=["c8yDeviceDatabase","c8yCanbusDevice"],angular.module("c8y.deviceDatabase4").factory("c8yCanbusDevice",e).run(t)}(),function(){"use strict";function e(e,t,n,a,i,s){function r(t,i){var s=l(t,i),r=s.then(n.createConfirm).then(e.getResData),u=r.then(_.partial(n.addChildDevice,t)),d=u.then(function(){return r.then(_.partialRight(o,t.owner)).then(n.save)}),m=d.then(function(){return r.then(_.partial(c,t,i.deviceType)).then(a.create)});return m}function l(e,n){var a={name:n.name,type:n.deviceType.name,c8y_OPCUADevice:{browsePath:n.directoryPath,type:"/inventory/managedObjects/"+n.deviceType.id}};return t.current().then(function(e){return a.owner=e.id,a})}function o(e,t){return e.owner=t,e}function c(e,t,n){return{deviceId:e.id,description:s.getString("Added new child device to {{name}} ({{id}})",e),c8y_OPCUADevice:{id:n.id,name:n.name,browsePath:n.c8y_OPCUADevice.browsePath,type:"/inventory/managedObjects/"+t.id}}}function u(e){return!!(e||{})[d]}var d="c8y_OPCUADevice",m={label:i("OPCUA"),fieldbusType:"opcua",options:!1,discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{sectionTitle:i("Variables"),noRegistersDefinedMessage:i("No variables defined."),elementTypeLabel:i("Variable"),newRegisterModalTitle:i("New variable"),editRegisterModalTitle:i('Edit variable: "{{name}}"'),validation:{invalidName:i("Name should be unique among variables!"),invalidMeasurement:i("Chosen measurement type and series are already used by another variable!")},browsePath:!0,nodeType:!0,attributeType:!0,multiplier:{min:1,step:1},divisor:!0,decimalPlaces:!0,options:{enumType:!0},functionalities:{showStatus:!0,updateStatus:!0}},inputRegisters:!1};return{FEATURES_MANIFEST:m,create:r,isOpcua:u}}function t(e,t){e.featuresManifests.push(t.FEATURES_MANIFEST)}e.$inject=["c8yBase","c8yUser","c8yDevices","c8yDeviceControl","gettext","gettextCatalog"],t.$inject=["c8yDeviceDatabase","c8yOPCUADevice"],angular.module("c8y.deviceDatabase4").factory("c8yOPCUADevice",e).run(t)}(),function(){"use strict";function e(e,t,n){function a(){i().then(function(e){e&&t.featuresManifests.push(r)})}function i(){return e.isAvailable(s)}var s={name:"actility-device-provider-agent"},r={label:n("LoRa"),fieldbusType:"actility",type:"c8y_ActilityDeviceType",configuration:{messageIdConfiguration:!0},discreteOutputs:!1,discreteInputs:!1,holdingRegisters:{sectionTitle:n("Values"),noRegistersDefinedMessage:n("No values defined."),newRegisterModalTitle:n("New value"),editRegisterModalTitle:n('Edit value: "{{name}}"'),validation:{invalidName:n("Name should be unique among values!"),invalidMeasurement:n("Chosen measurement type and series are already used by another value in the same message type!")},messageTypeId:!0,startBit:!0,noBits:!0,multiplier:!0,offset:!0,decimalPlaces:!1,options:{bcd:!0,littleEndian:!0},functionalities:{showStatus:!1,updateStatus:!1,raiseAlarm:{alarmStatus:!0},sendEvent:{fragmentType:!0,innerType:!0},sendManagedObjectUpdate:!0}},inputRegisters:!1,options:!1};return{FEATURES_MANIFEST:r,registerFeaturesManifest:a,isAvailable:i}}function t(e){e.registerFeaturesManifest()}e.$inject=["c8yApplication","c8yDeviceDatabase","gettext"],t.$inject=["c8yActilityDevice"],angular.module("c8y.deviceDatabase4").factory("c8yActilityDevice",e).run(t)}(),function(){"use strict";function e(e){function t(e){var t=[];return e&&e.c8y_CoilStatus&&(t.push(["c8y_CoilStatus"]),n(e.c8y_CoilStatus,["c8y_CoilStatus"],t)),e&&e.c8y_RegisterStatus&&(t.push(["c8y_RegisterStatus"]),n(e.c8y_RegisterStatus,["c8y_RegisterStatus"],t)),t}function n(e,t,a){return"Object"!==e.constructor.name?[]:void _.forEach(e,function(e,i){var s=t.concat([i]);a.push(s),n(e,s,a)})}function a(t){return{keyPath:t,label:e("humanize2")(_.last(t)),id:"c8yFieldbusProps!!"+t.join("!!"),fieldbus:!0}}return{generatePaths:t,createProperty:a}}angular.module("c8y.deviceDatabase4").factory("fieldbusPropertyGenerator",["$filter",e])}(),function(){"use strict";function e(){return{restrict:"A",require:"ngModel",link:function(e,t,n,a){function i(){var t,i={},s=n.uniquePropName,r=e.$eval(n.uniqueInArray);i[s]=a.$modelValue,t=!(r&&_.filter(r,i).length>1),a.$setValidity("unique",t)}e.$watch(n.uniqueInArray,i,!0),n.$observe(n.uniquePropName,i),e.$watch(function(){return a.$modelValue},i)}}}angular.module("c8y.deviceDatabase4").directive("unique",e)}(),function(){"use strict";function e(){function e(e,t,n,a){function i(t){var a=e.$eval(n.validateValueInRegisterRange);if(a){var i=Math.pow(10,a.decimalPlaces),s=(((t*i).toFixed(6)-(a.min*i).toFixed(6))/(a.step*i).toFixed(6)).toFixed(6);return s>=0&&s%1===0&&t<=a.max}}a.$validators["value-in-register-range"]=function(e){var t=!1;return _.isUndefined(e)||(t=i(e)),t},e.$watch(function(){return e.$eval(n.validateValueInRegisterRange)},function(){a.$validate()},!0)}return{restrict:"A",require:"ngModel",link:e}}angular.module("c8y.deviceDatabase4").directive("validateValueInRegisterRange",e)}(),function(){"use strict";function e(e){var t;t='<a title="{{match.label}}">\n  <span ng-bind-html="match.label | uibTypeaheadHighlight:query"></span>\n</a>\n',e.put("core_deviceDatabase4/views/categoryTypeahead.html",t),e.put("/apps/core/deviceDatabase4/views/categoryTypeahead.html",t),t='<div class="row">\n  <div class="form-group col-lg-4" ng-class="{\'has-error\': deviceTypeForm.deviceType.$dirty && deviceTypeForm.deviceType.$invalid}">\n    <label translate>Device type</label>\n    <select name="deviceType" class="form-control" ng-model="formValue.fieldbusType" ng-options="deviceTypeFeatures.fieldbusType as deviceTypeFeatures.label for deviceTypeFeatures in deviceTypesFeatures" ng-change="changeDeviceType()" ng-disabled="!isNew()" required>\n    </select>\n  </div>\n  <div class="form-group col-lg-4" ng-class="{\'has-error\': deviceTypeForm.name.$dirty && deviceTypeForm.name.$invalid}">\n    <label translate>Name</label>\n    <input name="name" type="text" class="form-control" ng-model="deviceType.name" ng-disabled="!isNew()" ng-maxlength="650" required>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/basic.html",t),e.put("/apps/core/deviceDatabase4/views/details/basic.html",t),t='<div class="panel panel-clean">\n  <div class="panel-heading">\n    <i c8y-icon="sliders"></i> <translate>Discrete inputs</translate>\n    <button class="btn btn-link pull-right" ng-click="addDiscreteInput()">\n      <i c8y-icon="plus"></i> <translate>Add</translate>\n    </button>\n  </div>\n  <div class="panel-body">\n    <div class="alert alert-warning" ng-show="isEmpty(discreteInputsCategorized)" translate>\n      No discrete inputs defined.\n    </div>\n    <table class="table table-hover elements-table" ng-hide="isEmpty(discreteInputsCategorized)">\n      <colgroup>\n          <col/>\n          <col class="buttons"/>\n      </colgroup>\n      <thead ng-repeat-start="(category, discreteInputs) in discreteInputsCategorized">\n        <tr>\n          <th colspan="2" class="category-header" ng-class="{\'text-muted\': !category}">\n            <span ng-if="category" ng-bind="category" title="{{category}}"></span>\n            <span ng-if="!category" ng-bind="\'Uncategorized\' | translate"></span>\n          </th>\n        </tr>\n      </thead>\n      <tbody ng-repeat-end>\n        <tr ng-repeat="discreteInput in discreteInputs | orderBy:\'number\'">\n          <td class="interact info" ng-click="editDiscreteInput(discreteInput)">\n            <span ng-bind="discreteInput.name"></span>\n            <small class="text-muted hidden-sm hidden-xs" style="margin-right: 10px">\n              <strong><span translate>Number</span>:</strong>\n              <span ng-bind="discreteInput.number"></span>\n            </small>\n          </td>\n          <td class="text-right">\n            <button class="btn btn-danger btn-xs showOnHover" uib-tooltip="{{\'Remove\' | translate}}" ng-click="removeDiscreteInput(discreteInput)">\n              <i c8y-icon="times"></i>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/discreteInputs.html",t),e.put("/apps/core/deviceDatabase4/views/details/discreteInputs.html",t),t='<div class="panel panel-clean">\n  <div class="panel-heading">\n    <i c8y-icon="sliders"></i> <translate>Coils (discrete outputs)</translate>\n    <button class="btn btn-link pull-right" ng-click="addDiscreteOutput()">\n      <i c8y-icon="plus"></i> <translate>Add</translate>\n    </button>\n  </div>\n  <div class="panel-body">\n    <div class="alert alert-warning" ng-show="isEmpty(discreteOutputsCategorized)" translate>\n      No coils defined.\n    </div>\n    <table class="table table-hover elements-table" ng-hide="isEmpty(discreteOutputsCategorized)">\n      <colgroup>\n          <col/>\n          <col class="buttons"/>\n      </colgroup>\n      <thead ng-repeat-start="(category, discreteOutputs) in discreteOutputsCategorized">\n        <tr>\n          <th colspan="2" class="category-header" ng-class="{\'text-muted\': !category}">\n            <span ng-if="category" ng-bind="category" title="{{category}}"></span>\n            <span ng-if="!category" ng-bind="\'Uncategorized\' | translate"></span>\n          </th>\n        </tr>\n      </thead>\n      <tbody ng-repeat-end>\n        <tr ng-repeat="discreteOutput in discreteOutputs | orderBy:\'number\'">\n          <td class="interact info" ng-click="editDiscreteOutput(discreteOutput)">\n            <span ng-bind="discreteOutput.name"></span>\n            <small class="text-muted hidden-sm hidden-xs" style="margin-right: 10px">\n              <strong><span translate>Number</span>:</strong>\n              <span ng-bind="discreteOutput.number"></span>\n            </small>\n          </td>\n          <td class="text-right">\n            <button class="btn btn-danger btn-xs showOnHover" uib-tooltip="{{\'Remove\' | translate}}" ng-click="removeDiscreteOutput(discreteOutput)">\n              <i c8y-icon="times"></i>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/discreteOutputs.html",t),e.put("/apps/core/deviceDatabase4/views/details/discreteOutputs.html",t),t='<div class="panel panel-clean">\n  <div class="panel-heading">\n    <i c8y-icon="tasks"></i>\n    <span ng-if="features.holdingRegisters.sectionTitle" ng-bind="features.holdingRegisters.sectionTitle | translate">\n    </span>\n    <span ng-if="!features.holdingRegisters.sectionTitle" ng-bind="\'Holding registers\' | translate">\n    </span>\n    <button class="btn btn-link pull-right" ng-click="addHoldingRegister()">\n      <i c8y-icon="plus"></i> <translate>Add</translate>\n    </button>\n  </div>\n  <div class="panel-body">\n    <div class="alert alert-warning" ng-show="isEmpty(holdingRegistersCategorized)">\n      <span ng-show="features.holdingRegisters.noRegistersDefinedMessage">\n        {{features.holdingRegisters.noRegistersDefinedMessage | translate}}\n      </span>\n      <span ng-hide="features.holdingRegisters.noRegistersDefinedMessage">\n        {{\'No holding registers defined.\' | translate}}\n      </span>\n    </div>\n    <table class="table table-hover elements-table" ng-hide="isEmpty(holdingRegistersCategorized)">\n      <colgroup>\n        <col/>\n        <col class="buttons"/>\n      </colgroup>\n      <thead ng-repeat-start="(category, holdingRegisters) in holdingRegistersCategorized">\n        <tr>\n          <th colspan="2" class="category-header" ng-class="{\'text-muted\': !category}">\n            <span ng-if="category" ng-bind="category" title="{{category}}"></span>\n            <span ng-if="!category" ng-bind="\'Uncategorized\' | translate"></span>\n          </th>\n        </tr>\n      </thead>\n      <tbody ng-repeat-end>\n        <tr ng-repeat="holdingRegister in holdingRegisters | orderBy:[\'number\',\'startBit\',\'browsePath\']">\n          <td class="interact info" ng-click="editHoldingRegister(holdingRegister)">\n            <span ng-bind="holdingRegister.name"></span>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.number">\n              <strong>\n                <span ng-bind="(features.holdingRegisters.number.label | translate) || (\'Number\' | translate)"></span>:\n              </strong>\n              <span ng-bind="holdingRegister.number"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.messageTypeId">\n              <strong>\n                <span ng-bind="(features.holdingRegisters.messageTypeId.label | translate) || (\'Message ID\' | translate)"></span>:\n              </strong>\n              <span ng-bind="holdingRegister.messageTypeId"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.startBit">\n              <strong><span translate>Start bit</span>:</strong>\n              <span ng-bind="holdingRegister.startBit"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.noBits">\n              <strong><span translate>Number of bits</span>:</strong>\n              <span ng-bind="holdingRegister.noBits"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.browsePath">\n              <strong><span translate>Browse path</span>:</strong>\n              <span ng-bind="holdingRegister.browsePath"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.nodeType">\n              <strong><span translate>Node type</span>:</strong>\n              <span ng-bind="holdingRegister.nodeType"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs registerDescription" ng-if="features.holdingRegisters.attributeType">\n              <strong><span translate>Attribute type</span>:</strong>\n              <span ng-bind="holdingRegister.attributeType"></span>\n            </small>\n          </td>\n          <td class="text-right">\n            <button class="btn btn-danger btn-xs showOnHover" uib-tooltip="{{\'Remove\' | translate}}" ng-click="removeHoldingRegister(holdingRegister)">\n              <i c8y-icon="times"></i>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/holdingRegisters.html",t),e.put("/apps/core/deviceDatabase4/views/details/holdingRegisters.html",t),t='<div ng-controller="deviceTypeDetailsCtrl">\n  <form role="form" name="deviceTypeForm" class="panel-body device-type-form" novalidate ng-show="deviceType">\n    <div ng-include="\'core_deviceDatabase4/views/details/basic.html\'"></div>\n    <div ng-include="\'core_deviceDatabase4/views/details/messageIdConfiguration.html\'"></div>\n\n    <div class="row">\n      <div ng-if="features.discreteOutputs" ng-class="{\n          \'col-lg-6\': features.discreteOutputs && features.discreteInputs,\n          \'col-lg-12\': !features.discreteInputs\n        }" ng-include="\'core_deviceDatabase4/views/details/discreteOutputs.html\'">\n      </div>\n      <div ng-if="features.discreteInputs" ng-class="{\n          \'col-lg-6\': features.discreteOutputs && features.discreteInputs,\n          \'col-lg-12\': !features.discreteOutputs\n        }" ng-include="\'core_deviceDatabase4/views/details/discreteInputs.html\'">\n      </div>\n    </div>\n\n    <div class="row">\n      <div ng-if="features.holdingRegisters" ng-class="{\n          \'col-lg-6\': features.holdingRegisters && features.inputRegisters,\n          \'col-lg-12\': !features.inputRegisters\n        }" ng-include="\'core_deviceDatabase4/views/details/holdingRegisters.html\'">\n      </div>\n      <div ng-if="features.inputRegisters" ng-class="{\n          \'col-lg-6\': features.holdingRegisters && features.inputRegisters,\n          \'col-lg-12\': !features.holdingRegisters\n        }" ng-include="\'core_deviceDatabase4/views/details/inputRegisters.html\'">\n      </div>\n    </div>\n\n    <div ng-include="\'core_deviceDatabase4/views/details/options.html\'"></div>\n\n    <c8y-if-allowed admin-mos="[deviceType.id]">\n    <button class="btn btn-primary" ng-click="save(deviceType)" ng-disabled="saveDisabled()" translate>\n      Save\n    </button>\n    </c8y-if-allowed>\n  </form>\n</div>\n',e.put("core_deviceDatabase4/views/details/index.html",t),e.put("/apps/core/deviceDatabase4/views/details/index.html",t),t='<div class="panel panel-clean">\n  <div class="panel-heading">\n    <i c8y-icon="tasks"></i> <translate>Input registers</translate>\n    <button class="btn btn-link pull-right" ng-click="addInputRegister()">\n      <i c8y-icon="plus"></i> <translate>Add</translate>\n    </button>\n  </div>\n  <div class="panel-body">\n    <div class="alert alert-warning" ng-show="isEmpty(inputRegistersCategorized)" translate>\n      No input registers defined.\n    </div>\n    <table class="table table-hover elements-table" ng-hide="isEmpty(inputRegistersCategorized)">\n      <colgroup>\n          <col/>\n          <col class="buttons"/>\n      </colgroup>\n      <thead ng-repeat-start="(category, inputRegisters) in inputRegistersCategorized">\n        <tr>\n          <th colspan="2" class="category-header" ng-class="{\'text-muted\': !category}">\n            <span ng-if="category" ng-bind="category" title="{{category}}"></span>\n            <span ng-if="!category" ng-bind="\'Uncategorized\' | translate"></span>\n          </th>\n        </tr>\n      </thead>\n      <tbody ng-repeat-end>\n        <tr ng-repeat="inputRegister in inputRegisters | orderBy:[\'number\',\'startBit\']">\n          <td class="interact info" ng-click="editInputRegister(inputRegister)">\n            <span ng-bind="inputRegister.name"></span>\n            <small class="text-muted hidden-sm hidden-xs" style="margin-right: 10px">\n              <strong><span translate>Number</span>:</strong>\n              <span ng-bind="inputRegister.number"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs" style="margin-right: 10px">\n              <strong><span translate>Start bit</span>:</strong>\n              <span ng-bind="inputRegister.startBit"></span>\n            </small>\n            <small class="text-muted hidden-sm hidden-xs" style="margin-right: 10px">\n              <strong><span translate>Number of bits</span>:</strong>\n              <span ng-bind="inputRegister.noBits"></span>\n            </small>\n          </td>\n          <td class="text-right">\n            <button class="btn btn-danger btn-xs showOnHover" title="{{\'Remove\' | translate}}" ng-click="removeInputRegister(inputRegister)">\n              <i c8y-icon="times"></i>\n            </button>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/inputRegisters.html",t),e.put("/apps/core/deviceDatabase4/views/details/inputRegisters.html",t),t='<div class="panel panel-clean" ng-if="features.configuration.messageIdConfiguration">\n  <div class="panel-heading">\n    <i c8y-icon="tasks"></i>\n    <translate>Message types</translate>\n  </div>\n  <div class="panel-body">\n    <div class="row">\n      <div class="col-lg-6">\n        <div class="alert alert-info" style="width: 100%" translate>\n          {{features.label | translate}} devices can send messages of different types with different encodings per type.\n          Depending on the device, the type can be determined by looking either\n          at the FPort parameter of a message (<b>Source</b>: <i>FPort</i>)\n          or at the subset of the message payload itself (<b>Source</b>: <i>Payload</i>).\n          If the type is inside the message payload,\n          indicate where the type information starts in the payload (<b>Start bit</b>)\n          and how long this information is (<b>Number of bits</b>).\n        </div>\n      </div>\n      <div class="col-lg-6">\n        <div class="row">\n          <div class="form-group col-lg-12" ng-class="{\'has-error\': deviceTypeForm.messageIdSource.$dirty && deviceTypeForm.deviceType.$invalid}" uib-tooltip="{{validationHints(form_element.messageIdSource)}}">\n            <label for="messageIdSource" translate>\n              Source\n            </label>\n            <select class="form-control" id="messageIdSource" name="messageIdSource" ng-model="deviceType.c8y_MessageIdConfiguration.source" ng-options="source.value as source.label for source in messageIdSources.values()" required>\n            </select>\n          </div>\n        </div>\n\n        <div class="row" ng-if="deviceType.c8y_MessageIdConfiguration.source === messageIdSources.PAYLOAD.value">\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': deviceTypeForm.messageIdStartBit.$dirty && deviceTypeForm.deviceType.$invalid}" uib-tooltip="{{validationHints(form_element.messageIdStartBit)}}">\n            <label for="messageIdStartBit">\n              <translate>Start bit</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'For example, if message type is indicated by the first byte of payload, then enter 0\' | translate}}"></i>\n            </label>\n            <input type="number" class="form-control" id="messageIdStartBit" name="messageIdStartBit" ng-model="deviceType.c8y_MessageIdConfiguration.messageIdMapping.startBit" ng-min="0" required>\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': deviceTypeForm.messageIdNoBits.$dirty && deviceTypeForm.deviceType.$invalid}" uib-tooltip="{{validationHints(form_element.messageIdNoBits)}}">\n            <label for="messageIdNoBits">\n              <translate>Number of bits</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'For example, if message type is indicated by the first byte of payload, then enter 8\' | translate}}"></i>\n            </label>\n            <input type="number" class="form-control" id="messageIdNoBits" name="messageIdNoBits" ng-model="deviceType.c8y_MessageIdConfiguration.messageIdMapping.noBits" ng-min="1" required>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',
e.put("core_deviceDatabase4/views/details/messageIdConfiguration.html",t),e.put("/apps/core/deviceDatabase4/views/details/messageIdConfiguration.html",t),t='<div class="panel panel-clean" ng-if="features.options">\n  <div class="panel-heading">\n    <i c8y-icon="list"></i> <translate>Options</translate>\n  </div>\n  <div class="panel-body">\n    <div class="row" ng-if="features.options.serverTime">\n      <div class="form-group col-lg-12">\n        <div class="checkbox">\n          <label>\n            <input type="checkbox" id="useServerTime" name="useServerTime" ng-model="deviceType.c8y_useServerTime">\n            <translate>Use server time</translate>\n          </label>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',e.put("core_deviceDatabase4/views/details/options.html",t),e.put("/apps/core/deviceDatabase4/views/details/options.html",t),t='<div class="modal-header">\n  <h3 translate>Import device type</h3>\n</div>\n<div class="modal-body">\n  <form class="deviceTypesSearchForm">\n    <div class="input-group">\n      <span class="input-group-btn" dropdown>\n        <button class="btn btn-default" disabled="disabled">\n          <i c8y-icon="search"></i>\n        </button>\n      </span>\n      <input type="search" class="form-control" placeholder="{{\'Search device type\' | translate}}&hellip;" ng-model="deviceTypesFilter.text"/>\n    </div>\n  </form>\n  <div class="command-templates-list list-group">\n    <label><span translate>Choose predefined device type</span>:</label>\n    <div ng-repeat="deviceTypeInfo in predefinedDeviceTypeInfos | filter:deviceTypesFilter.text" class="list-group-item interact" ng-class="{\'active\': isPredefinedDeviceTypeInfoSelected(deviceTypeInfo)}" ng-click="onPredefinedDeviceTypeInfoSelected(deviceTypeInfo)">\n      <!-- <button class="btn btn-primary btn-xs showOnHover pull-right"\n              uib-tooltip="{{\'Download\' | translate}}"\n              tooltip-append-to-body="true"\n              ng-click="downloadPredefinedDeviceType(deviceTypeInfo)">\n        <i c8y-icon="download"></i>\n      </button> -->\n      <a class="btn btn-primary btn-xs showOnHover pull-right" uib-tooltip="{{\'Download\' | translate}}" tooltip-append-to-body="true" download="{{downloadFileName(deviceTypeInfo)}}" ng-href="data:application/json;base64,{{downloadFileHref(deviceTypeInfo)}}">\n        <i c8y-icon="download"></i>\n      </a>\n      <span class="list-group-item-heading">\n        <span ng-bind="deviceTypeInfo.name"></span>\n        <small ng-show="deviceTypeInfo.category" class="text-muted" ng-bind="deviceTypeInfo.category"></small>\n      </span>\n      <span class="list-group-item-text">\n        <small class="text-muted" ng-bind="deviceTypeInfo.description"></small>\n      </span>\n    </div>\n  </div>\n  <div class="form-group">\n    <label><span translate>Or load it from file</span>:</label>\n    <div class="input-group" id="deviceTypeFileInput" ng-file-select="onCustomDeviceTypeFileSelected($files)">\n      <input type="text" readonly="readonly" required class="form-control" ng-model="selection.custom.file.name" placeholder="{{\'Choose file to upload\' | translate}}&hellip;">\n      <span class="input-group-btn">\n        <button class="btn btn-primary">\n          <span><i c8y-icon="upload"></i></span>\n        </button>\n      </span>\n    </div>\n  </div>\n  <form name="importForm">\n    <div class="form-group" ng-class="{\'has-error\': importForm.name.$dirty && importForm.name.$invalid}">\n      <label for="name"><span translate>And save with the following name</span>:</label>\n      <input id="name" name="name" type="text" class="form-control" ng-model="selection.newName.value" placeholder="{{\'New device type name\' | translate}}" ng-change="onNewNameEdited()" required>\n    </div>\n  </form>\n</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-primary" ng-click="import(selectedDeviceType)" ng-disabled="!((selection.predefined.deviceType || selection.custom.deviceType) && importForm.$valid)" translate>Import</button>\n  <button type="button" class="btn btn-default" ng-click="cancel()" translate>Cancel</button>\n</div>\n',e.put("core_deviceDatabase4/views/deviceTypeImport.html",t),e.put("/apps/core/deviceDatabase4/views/deviceTypeImport.html",t),t='<div class="modal-header" ng-show="title">\n  <h3 class="text-truncate" ng-bind="title | translate" title="{{title | translate}}"></h3>\n</div>\n<div class="modal-body">\n  <form role="form" name="forms.element" class="panel-body" novalidate ng-show="element">\n    <fieldset style="margin-top: -20px">\n      <div class="legend form-block center">\n        <translate>General</translate>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'name\')}" uib-tooltip="{{validationHints(forms.element.name)}}">\n          <label for="name" translate>\n            Name\n          </label>\n          <input type="text" class="form-control" id="name" name="name" ng-model="element.name" c8y-autocomplete="off" required>\n        </div>\n        <div class="form-group col-lg-6 category-form-group" ng-class="{\'has-error\': invalid(\'category\')}" uib-tooltip="{{validationHints(forms.element.category)}}">\n          <label for="category" translate>\n            Display category\n          </label>\n          <input type="text" class="form-control" id="category" name="category" ng-model="element.category" c8y-autocomplete="off" uib-typeahead="category.name for category in categories | filter:{name:$viewValue}" typeahead-template-url="core_deviceDatabase4/views/categoryTypeahead.html">\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>Value selection</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Indicate from where the value should be taken\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'number\')}" uib-tooltip="{{validationHints(forms.element.number)}}">\n          <label for="number" translate>\n            Number\n          </label>\n          <input type="number" class="form-control" id="number" name="number" ng-model="element.number" ng-min="1" ng-max="65536" step="1" required>\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>Functionalities</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Choose which actions to perform with the value\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6">\n          <div class="checkbox" ng-if="features.functionalities.showStatus">\n            <label>\n              <input type="checkbox" ng-model="element.meta.showStatus" ng-disabled="element.meta.updateStatus">\n              <translate>Show status (read-only access)</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Enable showing current value in UI (e.g. on Fieldbus widget)\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.functionalities.updateStatus && !element.input">\n            <label>\n              <input type="checkbox" ng-model="element.meta.updateStatus" ng-change="onUpdateStatusCheckboxClicked()">\n              <translate>Update status (read/write access)</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Enable changing current value from UI (e.g. using Fieldbus widget)\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.meta.raiseAlarm">\n              <translate>Raise alarm</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Create an alarm if the value is not equal to 0\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.meta.sendEvent">\n              <translate>Send event</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Create an event whenever the value is changed\' | translate}}"></i>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div class="row">\n        <div ng-show="element.meta.showStatus" ng-repeat="enumValue in element.meta.enumValues | limitTo:2">\n          <ng-form name="nestedEnumValueValueForm">\n            <div class="form-group col-lg-6" ng-class="{\'has-error\': nestedEnumValueValueForm.$dirty && nestedEnumValueValueForm.$invalid}">\n              <label>\n                <span ng-show="enumValue.value === 0" translate>Text to show if value is zero</span>\n                <span ng-show="enumValue.value === 1" translate>Text to show if value is one</span>\n              </label>\n              <input type="text" class="form-control" ng-model="enumValue.label" ng-required="element.meta.showStatus">\n            </div>\n          </ng-form>\n        </div>\n      </div>\n      <div class="row" ng-show="element.meta.raiseAlarm">\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmType\')}" uib-tooltip="{{validationHints(forms.element.alarmType)}}">\n          <label for="alarmType" translate>\n            Alarm type\n          </label>\n          <input type="text" class="form-control" id="alarmType" name="alarmType" ng-model="element.alarmMapping.type" ng-required="element.meta.raiseAlarm">\n        </div>\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmText\')}" uib-tooltip="{{validationHints(forms.element.alarmText)}}">\n          <label for="alarmText" translate>\n            Alarm text\n          </label>\n          <input type="text" class="form-control" id="alarmText" name="alarmText" ng-model="element.alarmMapping.text" ng-required="element.meta.raiseAlarm">\n        </div>\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmSeverity\')}" uib-tooltip="{{validationHints(forms.element.alarmSeverity)}}">\n          <label for="alarmSeverity" translate>\n            Alarm severity\n          </label>\n          <select class="form-control" id="alarmSeverity" name="alarmSeverity" ng-model="element.alarmMapping.severity" ng-options="(severity | translate) for severity in alarmSeverities" ng-required="element.meta.raiseAlarm">\n          </select>\n        </div>\n      </div>\n      <div class="row" ng-show="element.meta.sendEvent">\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventType\')}" uib-tooltip="{{validationHints(forms.element.eventType)}}">\n          <label for="eventType" translate>\n            Event type\n          </label>\n          <input type="text" class="form-control" id="eventType" name="eventType" ng-model="element.eventMapping.type" ng-required="element.meta.sendEvent">\n        </div>\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventText\')}" uib-tooltip="{{validationHints(forms.element.eventText)}}">\n          <label for="eventText" translate>\n            Event text\n          </label>\n          <input type="text" class="form-control" id="eventText" name="eventText" ng-model="element.eventMapping.text" ng-required="element.meta.sendEvent">\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-disabled="forms.element.$invalid" ng-click="save()" translate>\n    OK\n  </button>\n  <button class="btn btn-default" ng-click="dismiss()" translate>\n    Close\n  </button>\n</div>\n',e.put("core_deviceDatabase4/views/discreteIOModal.html",t),e.put("/apps/core/deviceDatabase4/views/discreteIOModal.html",t),t='<div class="modal-header">\n  <h3>{{\'Select properties\' | translate}}</h3>\n</div>\n<div class="modal-body">\n  <div class="form-group">\n    <input class="form-control" placeholder="{{\'Search property\' | translate}}" ng-model="ctrl.search.$"/>\n  </div>\n  <div class="row form-group" style="border-bottom: 1px solid #ddd; vertical-align: bottom">\n    <div class="col-lg-2">\n      <label>{{\'Show\' | translate}}</label>\n    </div>\n    <div class="col-lg-4">\n      <label>{{\'Label\' | translate}}</label>\n    </div>\n    <div class="col-lg-6">\n      <label>{{\'Property\' | translate}}</label>\n    </div>\n  </div>\n  <div class="form-group">\n    <div class="row property" ng-class="{\'bg-info\': ctrl.isParent(property)}" ng-repeat="property in ctrl.properties | orderBy:ctrl.orderByFn | filter:ctrl.search">\n      <div class="col-lg-2">\n        <input ng-if="!ctrl.isParent(property)" name="property" type="radio" ng-model="ctrl.selected" ng-value="property">\n      </div>\n      <div class="col-lg-4">\n        {{property.label}}\n      </div>\n      <div class="col-lg-6">\n        {{property.keyPath.join(\'.\')}}\n      </div>\n    </div>\n    <p ng-if="!ctrl.properties.length" class="bg-warning" style="padding: 20px" translate>\n      The selected device does not have coil status and register properties.\n    </p>\n  </div>\n</div>\n<div class="modal-footer">\n  <button type="button" ng-disabled="!ctrl.selected" class="btn btn-primary" ng-click="$close(ctrl.selected)">{{\'Select\' | translate}}</button>\n  <button type="button" class="btn btn-default" ng-click="$dismiss()">{{\'Cancel\' | translate}}</button>\n</div>\n',e.put("core_deviceDatabase4/views/fieldbusPropertySelector.html",t),e.put("/apps/core/deviceDatabase4/views/fieldbusPropertySelector.html",t),t='<div ng-controller="deviceTypesListCtrl">\n  <div class="clearfix">\n    <c8y-refresh-btn class="pull-right" style="margin-bottom:20px"></c8y-refresh-btn>\n    <c8y-if-allowed any-role="[\'ROLE_INVENTORY_ADMIN\', \'ROLE_INVENTORY_CREATE\']">\n    <button class="btn btn-link pull-right" ng-click="importDeviceType()">\n      <i c8y-icon="upload"></i> <translate>Import</translate>\n    </button>\n    <button class="btn btn-link pull-right" ng-click="addDeviceType()">\n      <i c8y-icon="plus"></i> <translate>New</translate>\n    </button>\n    </c8y-if-allowed>\n  </div>\n\n  <div class="alert alert-warning" ng-show="deviceTypes.length === 0" translate>\n    No device types found.\n  </div>\n\n  <table class="table table-hover" ng-show="deviceTypes.length > 0">\n    <tr ng-repeat="deviceType in deviceTypes | orderBy:\'name\'">\n      <td class="interact word-break" ng-click="navigateToDetails(deviceType)" ng-bind="deviceType.name"></td>\n      <td class="text-right word-nobreak">\n        <c8y-if-allowed admin-mos="[deviceType.id]">\n        <button class="btn btn-primary btn-xs showOnHover" uib-tooltip="{{\'Export\' | translate}}" ng-click="onClickExport(deviceType)">\n          <i c8y-icon="download"></i>\n        </button>\n        <button class="btn btn-danger btn-xs showOnHover" uib-tooltip="{{\'Remove\' | translate}}" ng-click="onClickDelete(deviceType)" style="margin-left:10px">\n          <i c8y-icon="times"></i>\n        </button>\n        </c8y-if-allowed>\n      </td>\n    </tr>\n  </table>\n\n  <c8y-load-more></c8y-load-more>\n</div>\n',e.put("core_deviceDatabase4/views/list.html",t),e.put("/apps/core/deviceDatabase4/views/list.html",t),t='<div class="modal-header" ng-show="title">\n  <h3 class="text-truncate" ng-bind="title | translate" title="{{title | translate}}"></h3>\n</div>\n<div class="modal-body">\n  <form role="form" name="form_element" class="panel-body" ng-show="element" novalidate>\n    <fieldset style="margin-top: -20px" ng-if="features.messageTypeId">\n      <div class="legend form-block center">\n        <translate>Message type</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Choose from which message type the value should be extracted\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'messageTypeId\')}" uib-tooltip="{{validationHints(form_element.messageTypeId)}}">\n          <label for="messageTypeId">\n            {{\'Message ID\' | translate}}\n            <i c8y-icon="question-circle" uib-tooltip="{{\'This will be matched with message ID found in source specified on device type main page\' | translate}}"></i>\n          </label>\n          <input type="number" class="form-control" id="messageTypeId" name="messageTypeId" ng-model="element.messageTypeId" ng-min="0" ng-max="messageTypeIdMax()" required>\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>General</translate>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'name\')}" uib-tooltip="{{validationHints(form_element.name)}}">\n          <label for="name" translate>\n            Name\n          </label>\n          <input type="text" class="form-control" id="name" name="name" ng-model="element.name" c8y-autocomplete="off" required>\n        </div>\n        <div class="form-group col-lg-6 category-form-group" ng-class="{\'has-error\': invalid(\'category\')}" uib-tooltip="{{validationHints(form_element.category)}}">\n          <label for="category" translate>\n            Display category\n          </label>\n          <input type="text" class="form-control" id="category" name="category" ng-model="element.category" c8y-autocomplete="off" uib-typeahead="category.name for category in categories | filter:{name:$viewValue}" typeahead-template-url="core_deviceDatabase4/views/categoryTypeahead.html">\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>Value selection</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Indicate from where the value should be extracted\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div ng-if="features.number" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'number\')}" uib-tooltip="{{validationHints(form_element.number)}}">\n          <label for="number">\n            <span ng-bind="(features.number.label | translate) || (\'Number\' | translate)"></span>\n          </label>\n          <input ng-if="!features.number.useHex" type="number" class="form-control" id="number" name="number" ng-model="element.number" ng-min="1" ng-max="65536" step="1" required>\n          <input ng-if="features.number.useHex" type="text" class="form-control" id="number" name="number" ng-model="element.number" placeholder="{{\'Hexadecimal number\' | translate}}" required>\n        </div>\n        <div ng-if="features.browsePath" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'browsePath\')}" uib-tooltip="{{validationHints(form_element.browsePath)}}">\n          <label for="browsePath" translate>Browse path</label>\n          <input type="text" class="form-control" id="browsePath" name="browsePath" ng-model="element.browsePath" placeholder="{{\'e.g.: 4:Boilers/4:Boiler #1\' | translate}}" required>\n        </div>\n        <div ng-if="features.startBit" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'startBit\')}" uib-tooltip="{{validationHints(form_element.startBit)}}">\n          <label for="startBit" translate>\n            Start bit\n          </label>\n          <input type="number" class="form-control" id="startBit" name="startBit" ng-model="element.startBit" ng-min="0" ng-max="startBitMax()" step="1" required>\n        </div>\n        <div ng-if="features.noBits" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'noBits\')}" uib-tooltip="{{validationHints(form_element.noBits)}}">\n          <label for="noBits" translate>\n            Number of bits\n          </label>\n          <input type="number" class="form-control" id="noBits" name="noBits" ng-model="element.noBits" ng-min="1" ng-max="noBitsMax(element.startBit)" step="1" required>\n        </div>\n        <div ng-if="features.nodeType" class="form-group col-lg-4" uib-tooltip="{{validationHints(form_element.nodeType)}}">\n          <label for="nodeTypeValue" translate>\n            Node type\n          </label>\n          <select class="form-control" id="nodeTypeValue" name="nodeTypeValue" ng-model="element.nodeType" ng-init="element.nodeType=\'Variable\'" disabled="disabled">\n            <option value="Variable">Variable</option>\n          </select>\n        </div>\n        <div ng-if="features.attributeType" class="form-group col-lg-4" uib-tooltip="{{validationHints(form_element.attributeType)}}">\n          <label for="attributeType" translate>\n            Attribute type\n          </label>\n          <input type="text" class="form-control" id="attributeType" name="attributeType" ng-model="element.attributeType" ng-init="element.attributeType=\'Value\'" disabled="disabled">\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>Value normalisation</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Define how the raw value should be transformed before storing in the platform\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div ng-if="features.multiplier" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'multiplier\')}" uib-tooltip="{{validationHints(form_element.multiplier)}}">\n          <label for="multiplier" translate>\n            Multiplier\n          </label>\n          <input type="number" class="form-control" id="multiplier" name="multiplier" ng-model="element.multiplier" ng-min="features.multiplier.min" step="{{features.multiplier.step}}" required>\n        </div>\n        <div ng-if="features.divisor" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'divisor\')}" uib-tooltip="{{validationHints(form_element.divisor)}}">\n          <label for="divisor" translate>\n            Divisor\n          </label>\n          <input type="number" class="form-control" id="divisor" name="divisor" ng-model="element.divisor" ng-min="1" step="1" required>\n        </div>\n        <div ng-if="features.offset" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'offset\')}" uib-tooltip="{{validationHints(form_element.offset)}}">\n          <label for="offset" translate>\n            Offset\n          </label>\n          <input type="number" class="form-control" id="offset" name="offset" ng-model="element.offset" ng-min="features.offset.min" ng-max="features.offset.max" step="{{features.offset.step}}" required>\n        </div>\n        <div ng-if="features.decimalPlaces" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'decimalPlaces\')}" uib-tooltip="{{validationHints(form_element.decimalPlaces)}}">\n          <label for="decimalPlaces" translate>\n            Decimal places\n          </label>\n          <input type="number" class="form-control" id="decimalPlaces" name="decimalPlaces" ng-model="element.decimalPlaces" ng-min="0" ng-max="5" step="1" required>\n        </div>\n        <div class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'unit\')}" uib-tooltip="{{validationHints(form_element.unit)}}">\n          <label for="unit" translate>\n            Unit\n          </label>\n          <input type="text" class="form-control" id="unit" name="unit" ng-model="element.unit">\n        </div>\n        <div ng-if="element.meta.updateStatus" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'min\')}" uib-tooltip="{{validationHints(form_element.min, {validateValueInRegisterRange: element.meta.valuesRange.base})}}">\n          <label for="min" translate>\n            Minimum\n          </label>\n          <input type="number" class="form-control" id="min" name="min" ng-model="element.min" ng-min="element.meta.valuesRange.base.min" ng-max="element.meta.valuesRange.custom.max" step="{{element.meta.valuesRange.base.step}}" validate-value-in-register-range="element.meta.valuesRange.base" placeholder="{{getValuePlaceholder(element.meta.valuesRange.base.min)}}" required>\n        </div>\n        <div ng-if="element.meta.updateStatus" class="form-group col-lg-4" ng-class="{\'has-error\': invalid(\'max\')}" uib-tooltip="{{validationHints(form_element.max, {validateValueInRegisterRange: element.meta.valuesRange.base})}}">\n          <label for="max" translate>\n            Maximum\n          </label>\n          <input type="number" class="form-control" id="max" name="max" ng-model="element.max" ng-min="element.meta.valuesRange.custom.min" ng-max="element.meta.valuesRange.base.max" step="{{element.meta.valuesRange.base.step}}" validate-value-in-register-range="element.meta.valuesRange.base" placeholder="{{getValuePlaceholder(element.meta.valuesRange.base.max)}}" required>\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center" translate>\n        Options\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6">\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.signed">\n              <translate>Signed</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Check if the value is signed number\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.options.enumType">\n            <label>\n              <input type="checkbox" ng-model="element.meta.enumType">\n              <translate>Enumeration type</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Check to define the mapping of possible values into strings\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.options.bcd">\n            <label>\n              <input type="checkbox" ng-model="element.bcd">\n              <translate>Packed decimal</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Check if the value is BCD encoded\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.options.littleEndian">\n            <label>\n              <input type="checkbox" ng-model="element.littleEndian">\n              <translate>Little-endian</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Check if the value is represented in little-endian format\' | translate}}"></i>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div class="row" ng-show="element.meta.enumType">\n        <div class="form-group col-lg-12">\n          <label translate>Enumeration values</label>\n          <div ng-repeat="enumValue in element.meta.enumValues">\n            <div class="row">\n              <ng-form name="nestedEnumValueValueForm">\n                <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedEnumValueValueForm.$dirty && nestedEnumValueValueForm.$invalid}" uib-tooltip="{{validationHints(nestedEnumValueValueForm, {validateValueInRegisterRange: element.meta.valuesRange.custom})}}">\n                  <input type="number" class="form-control" ng-model="enumValue.value" ng-min="element.meta.valuesRange.custom.min" ng-max="element.meta.valuesRange.custom.max" step="{{element.meta.valuesRange.custom.step}}" validate-value-in-register-range="element.meta.valuesRange.custom" unique unique-in-array="element.meta.enumValues" unique-prop-name="value" placeholder="{{\'Value\' | translate}}" uib-tooltip="{{\'Value\' | translate}}" required>\n                </div>\n              </ng-form>\n              <ng-form name="nestedEnumValueLabelForm">\n                <div class="form-group col-lg-4" ng-class="{\'has-error\': nestedEnumValueLabelForm.$dirty && nestedEnumValueLabelForm.$invalid}" uib-tooltip="{{validationHints(nestedEnumValueLabelForm)}}">\n                  <input type="text" class="form-control" ng-model="enumValue.label" placeholder="{{\'Label\' | translate}}" uib-tooltip="{{\'Label\' | translate}}" required/>\n                </div>\n              </ng-form>\n              <a class="btn btn-link pull-right" ng-click="removeEnumValue(element, enumValue)">\n                <i c8y-icon="minus"></i> <translate>Remove value</translate>\n              </a>\n            </div>\n          </div>\n          <div class="row">\n            <a class="btn btn-link left" ng-click="addEnumValue(element)">\n              <i c8y-icon="plus"></i> <translate>Add value</translate>\n            </a>\n          </div>\n        </div>\n      </div>\n    </fieldset>\n\n    <fieldset>\n      <div class="legend form-block center">\n        <translate>Functionalities</translate>\n        <i c8y-icon="question-circle" uib-tooltip="{{\'Choose which actions to perform with the value\' | translate}}"></i>\n      </div>\n\n      <div class="row">\n        <div class="form-group col-lg-6">\n          <div class="checkbox" ng-if="features.functionalities.showStatus">\n            <label>\n              <input type="checkbox" ng-model="element.meta.showStatus" ng-disabled="element.meta.updateStatus">\n              <translate>Show status (read-only access)</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Enable showing current value in UI (e.g. on Fieldbus widget)\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.functionalities.updateStatus && !element.input">\n            <label>\n              <input type="checkbox" ng-model="element.meta.updateStatus" ng-change="onUpdateStatusCheckboxClicked()">\n              <translate>Update status (read/write access)</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Enable changing current value from UI (e.g. using Fieldbus widget)\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.meta.sendMeasurement">\n              <translate>Send measurement</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Create a measurement whenever the value is changed\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.meta.raiseAlarm">\n              <translate>Raise alarm</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Create an alarm if the value is not equal to 0\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox">\n            <label>\n              <input type="checkbox" ng-model="element.meta.sendEvent">\n              <translate>Send event</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Create an event whenever the value is changed\' | translate}}"></i>\n            </label>\n          </div>\n          <div class="checkbox" ng-if="features.functionalities.sendManagedObjectUpdate">\n            <label>\n              <input type="checkbox" ng-model="element.meta.sendManagedObjectUpdate">\n              <translate>Update managed object</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Update a fragment in managed object whenever the value is changed\' | translate}}"></i>\n            </label>\n          </div>\n        </div>\n      </div>\n      <div ng-show="element.meta.sendMeasurement">\n        <div class="row">\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'measurementType\')}" uib-tooltip="{{validationHints(form_element.measurementType)}}">\n            <label for="measurementType" translate>\n              Measurement type\n            </label>\n            <input type="text" class="form-control" id="measurementType" name="measurementType" ng-pattern="PATTERN_VALIDATE_FRAGMENT_SERIES" ng-model="element.measurementMapping.type" ng-required="element.meta.sendMeasurement">\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'measurementSeries\')}" uib-tooltip="{{validationHints(form_element.measurementSeries)}}">\n            <label for="measurementSeries" translate>\n              Measurement series\n            </label>\n            <input type="text" class="form-control" id="measurementSeries" name="measurementSeries" ng-pattern="PATTERN_VALIDATE_FRAGMENT_SERIES" ng-model="element.measurementMapping.series" ng-required="element.meta.sendMeasurement">\n          </div>\n        </div>\n      </div>\n      <div ng-show="element.meta.raiseAlarm">\n        <div class="row">\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmType\')}" uib-tooltip="{{validationHints(form_element.alarmType)}}">\n            <label for="alarmType" translate>\n              Alarm type\n            </label>\n            <input type="text" class="form-control" id="alarmType" name="alarmType" ng-model="element.alarmMapping.type" ng-required="element.meta.raiseAlarm">\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmText\')}" uib-tooltip="{{validationHints(form_element.alarmText)}}">\n            <label for="alarmText" translate>\n              Alarm text\n            </label>\n            <input type="text" class="form-control" id="alarmText" name="alarmText" ng-model="element.alarmMapping.text" ng-required="element.meta.raiseAlarm">\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'alarmSeverity\')}" uib-tooltip="{{validationHints(form_element.alarmSeverity)}}">\n            <label for="alarmSeverity" translate>\n              Alarm severity\n            </label>\n            <select class="form-control" id="alarmSeverity" name="alarmSeverity" ng-model="element.alarmMapping.severity" ng-options="(severity | translate) for severity in alarmSeverities" ng-required="element.meta.raiseAlarm">\n            </select>\n          </div>\n        </div>\n      </div>\n      <div ng-show="element.meta.sendEvent">\n        <div class="row">\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventType\')}" uib-tooltip="{{validationHints(form_element.eventType)}}">\n            <label for="eventType" translate>\n              Event type\n            </label>\n            <input type="text" class="form-control" id="eventType" name="eventType" ng-model="element.eventMapping.type" ng-required="element.meta.sendEvent">\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventText\')}" uib-tooltip="{{validationHints(form_element.eventText)}}">\n            <label for="eventText" translate>\n              Event text\n            </label>\n            <input type="text" class="form-control" id="eventText" name="eventText" ng-model="element.eventMapping.text" ng-required="element.meta.sendEvent">\n          </div>\n        </div>\n        <div class="row" ng-if="features.functionalities.sendEvent.fragmentType || features.functionalities.sendEvent.innerType">\n          <div ng-if="features.functionalities.sendEvent.fragmentType" class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventFragmentType\')}" uib-tooltip="{{validationHints(form_element.eventFragmentType)}}">\n            <label for="eventFragmentType" translate>\n              Event fragment\n            </label>\n            <input type="text" class="form-control" id="eventFragmentType" name="eventFragmentType" ng-model="element.eventMapping.fragmentType">\n          </div>\n          <div ng-if="features.functionalities.sendEvent.innerType" class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'eventInnerType\')}" uib-tooltip="{{validationHints(form_element.eventInnerType)}}">\n            <label for="eventInnerType">\n              <translate>Event property</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Property nested inside the fragment\' | translate}}"></i>\n            </label>\n            <input type="text" class="form-control" id="eventInnerType" name="eventInnerType" ng-model="element.eventMapping.innerType">\n          </div>\n        </div>\n      </div>\n      <div ng-show="element.meta.sendManagedObjectUpdate">\n        <div class="row">\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'managedObjectFragmentType\')}" uib-tooltip="{{validationHints(form_element.managedObjectFragmentType)}}">\n            <label for="managedObjectFragmentType" translate>\n              Managed object fragment\n            </label>\n            <input type="text" class="form-control" id="managedObjectFragmentType" name="managedObjectFragmentType" ng-model="element.managedObjectMapping.fragmentType" ng-required="element.meta.sendManagedObjectUpdate">\n          </div>\n          <div class="form-group col-lg-6" ng-class="{\'has-error\': invalid(\'managedObjectInnerType\')}" uib-tooltip="{{validationHints(form_element.managedObjectInnerType)}}">\n            <label for="managedObjectInnerType">\n              <translate>Managed object property</translate>\n              <i c8y-icon="question-circle" uib-tooltip="{{\'Property nested inside the fragment\' | translate}}"></i>\n            </label>\n            <input type="text" class="form-control" id="managedObjectInnerType" name="managedObjectInnerType" ng-model="element.managedObjectMapping.innerType">\n          </div>\n        </div>\n      </div>\n    </fieldset>\n  </form>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-primary" ng-disabled="form_element.$invalid" ng-click="save()" translate>\n    OK\n  </button>\n  <button class="btn btn-default" ng-click="dismiss()" translate>\n    Close\n  </button>\n</div>\n',
e.put("core_deviceDatabase4/views/registerModal.html",t),e.put("/apps/core/deviceDatabase4/views/registerModal.html",t)}angular.module("c8y.deviceDatabase4").run(["$templateCache",e])}();