/* core_switchDisplay 8.21.0 2018-01-30T22:09:37+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";function t(t,e){t.add({name:"Data point status",nameDisplay:e("Data point status"),description:e("Displays in realtime the status of any binary data point."),templateUrl:"core_switchDisplay/views/widget.html",configTemplateUrl:"core_switchDisplay/views/config.html",options:{groupsSelectable:!1,noNewWidgets:!n()}})}function n(){var t=window.C8Y_APP||{},n=t.C8Y_INSTANCE_OPTIONS||{};return"dt"===n.target}t.$inject=["c8yComponentsProvider","gettext"],angular.module("c8y.switchDisplay",[]).config(t)}(),function(){"use strict";function t(t,n,e,i,s,c){function a(){var n=["/managedobjects/",l()].join("");c.addListener(t.$id,n,c.realtimeActions().UPDATE,function(t,n){d(n)}),c.start(t.$id,n),t.$on("$destroy",function(){c.stop(t.$id,n)})}function l(){var e=n.deviceId;return t.child.config&&t.child.config.device&&t.child.config.device.id?t.child.config.device.id:e}function o(){var t=l();return s.detail(t).then(function(t){return i.getResData(t)})}function r(t,n){if(t){n=n.split(".");for(var e=t[n[0]],i=1;i<n.length&&e;i++)e=e[n[i]];return""+e}}function d(n){_.forEach(t.switches,function(t){t.value=r(n,t.property)})}t.$watch("child.config.switches",function(n){t.switches=n,o().then(d)}),t.getValue=r,a()}angular.module("c8y.switchDisplay").controller("switchDisplayCtrl",["$scope","$routeParams","$q","c8yBase","c8yInventory","c8yRealtime",t])}(),function(){"use strict";function t(t,n){function e(){t.config.switches=t.config.switches||[],t.switchesTemp=_.cloneDeep(t.config.switches)}function i(){return{newSwitch:!0,name:n.getString("Switch")+" "+t.config.switches.length,property:"",activeValue:"",inactiValue:"",activeLabel:n.getString("Active"),inactiveLabel:n.getString("Inactive")}}function s(n){var e=t.switchesTemp[n];e.newSwitch?(delete e.newSwitch,t.config.switches.push(e)):t.config.switches[n]=_.clone(e)}function c(){t.switchesTemp.push(i())}function a(n){t.config.switches.splice(n,1),t.switchesTemp.splice(n,1)}e(),t.saveSwitch=s,t.deleteSwitch=a,t.addSwitch=c}angular.module("c8y.switchDisplay").controller("switchDisplayConfig",["$scope","gettextCatalog",t])}(),function(){"use strict";function t(t){var n;n='<div class="switchDisplayConfig" ng-controller="switchDisplayConfig">\n  <table class="table" ng-repeat-start="(index, switch) in switchesTemp">\n    <tr>\n      <td colspan="2" class="labels"><label translate>Managed object property</label></td>\n      <td colspan="2" class="labels"><label translate>Data point name</label></td>\n    </tr>\n    <tr>\n      <td colspan="2" class="inputs"><input placeholder="c8y_Relay.relayState" ng-model="switch.property"/></td>\n      <td colspan="2" class="inputs"><input ng-model="switch.name"/></td>\n    </tr>\n    <tr>\n      <td class="labels"><label translate>Value for active</label></td>\n      <td class="labels"><label translate>Label for active</label></td>\n      <td class="labels"><label translate>Value for inactive</label></td>\n      <td class="labels"><label translate>Label for inactive</label></td>\n    </tr>\n    <tr>\n      <td class="inputs"><input placeholder="OPEN" ng-model="switch.activeValue"/></td>\n      <td class="inputs"><input ng-model="switch.activeLabel"/></td>\n      <td class="inputs"><input placeholder="CLOSED" ng-model="switch.inactiveValue"/></td>\n      <td class="inputs"><input ng-model="switch.inactiveLabel"/></td>\n    </tr>\n  </table>\n  <div class="buttonsExistingSwitches actionButtons" ng-if="!switch.newSwitch">\n    <button class="btn btn-primary" ng-click="saveSwitch(index)" translate>Update configuration</button>\n    <button class="btn btn-link" ng-click="deleteSwitch(index)">\n      <i class="icon" c8y-icon="times"></i>\n      <span translate>Delete configuration</span>\n    </button>\n  </div>\n  <div class="actionButtons" ng-repeat-end ng-if="switch.newSwitch">\n    <button class="btn btn-primary" ng-click="saveSwitch(index)" translate>Save configuration</button>\n  </div>\n  <div ng-if="!(switchesTemp.length && switchesTemp[switchesTemp.length-1].newSwitch)">\n    <button class="btn btn-default" ng-click="addSwitch(index)">\n      <i class="icon" c8y-icon="plus-circle"></i>\n      <span translate>Add configuration</span>\n    </button>\n  </div>\n\n  <input name="switchConfig" ng-model="config.switches.length" type="hidden" pattern="[^0]">\n  <p ng-if="config.switches.length === 0" style="margin-top: 20px" class="has-error">\n    <span style="display: inline-block" class="help-block">\n      <i c8y-icon="exclamation-triangle"></i>\n      <span translate>\n        At least one configuration needs to be added.\n      </span>\n    </span>\n  </p>\n</div>\n',t.put("core_switchDisplay/views/config.html",n),t.put("/apps/core/switchDisplay/views/config.html",n),n='\n<table class="table switchDisplay" ng-controller="switchDisplayCtrl">\n  <tr ng-repeat="switch in switches">\n    <td>{{switch.name}}</td>\n    <td class="statusButton text-center text-muted" ng-class="{activeState: switch.value === switch.activeValue}">\n      <i class="icon" c8y-icon="check"></i>{{switch.activeLabel}}\n    </td>\n    <td class="statusButton text-center text-muted" ng-class="{inactiveState: switch.value === switch.inactiveValue}">\n      <i class="icon" c8y-icon="times"></i>{{switch.inactiveLabel}}\n    </td>\n  </tr>\n</table>\n',t.put("core_switchDisplay/views/widget.html",n),t.put("/apps/core/switchDisplay/views/widget.html",n)}angular.module("c8y.switchDisplay").run(["$templateCache",t])}();