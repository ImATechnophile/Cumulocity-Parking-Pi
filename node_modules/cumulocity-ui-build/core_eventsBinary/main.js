/* core_eventsBinary 8.21.0 2018-01-30T22:08:37+00:00 ab57d6f7e859+ (release/8.21.0) r8.21.0 */
!function(){"use strict";angular.module("c8y.eventsBinary",[])}(),function(){"use strict";function n(n,e){function t(){var t=n.doesContainBinary(o.event);t&&n.downloadAsDataUri(o.event).then(function(n){e.isImage(o.event.c8y_IsBinary)&&(o.dataUri=n)})}var o=this;_.assign(o,{$onInit:t})}n.$inject=["eventsBinaryService","c8yBinary"],angular.module("c8y.eventsBinary").component("c8yEventBinaryPreview",{templateUrl:"core_eventsBinary/components/eventBinaryPreview/eventBinaryPreview.html",bindings:{event:"<"},controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n){function e(){u.show=n.doesContainBinary(u.event),i(v,u.event)}function t(n){n.event&&i(v,n.event.currentValue)}function o(){v=_.map(u.availableControls?u.availableControls.split(","):[],_.trim),v.length||(u.enableDownload&&v.push(y.DOWNLOAD),u.enableUpload&&v.push(y.UPLOAD))}function i(e,t){o(),n.canDownload(t)?_.pull(v,y.UPLOAD):_.pull(v,y.DOWNLOAD)}function a(){n.downloadAndSaveAs(u.event)}function r(n){l=n.target.files[0]}function c(){n.upload(l,u.event)}function s(n){return!_.has(u.event,"c8y_IsIncompleteBinary")&&_.includes(v,n)}var l,v,u=this,y={DOWNLOAD:"download",UPLOAD:"upload"};_.assign(u,{$onInit:e,$onChanges:t,download:a,onNewImageSelected:r,upload:c,checkControlAvailable:s})}n.$inject=["eventsBinaryService"],angular.module("c8y.eventsBinary").component("c8yEventBinaryActions",{templateUrl:"core_eventsBinary/components/eventBinaryActions/eventBinaryActions.html",bindings:{event:"<",availableControls:"@",enableDownload:"<?",enableUpload:"<?"},controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n,e){function t(){a.icon=i(a.event)}function o(n){a.icon=i(n.event.currentValue)}function i(t){if(n.doesContainBinary(t))return e.icon(t.c8y_IsBinary)}var a=this;_.assign(a,{$onInit:t,$onChanges:o})}n.$inject=["eventsBinaryService","c8yBinary"],angular.module("c8y.eventsBinary").component("c8yEventBinaryIcon",{template:'<i c8y-icon="{{vm.icon}}" ng-if="vm.icon"></i>',bindings:{event:"<"},controller:n,controllerAs:"vm"})}(),function(){"use strict";function n(n,e,t,o,i,a){function r(n){var e=n.id,t=_.get(n,"c8y_IsBinary.length"),i=o.url([u,e,"binaries"].join("/"));return a.download(e,i,t).then(function(n){var e=n.getResponseHeader("Content-Type"),t=a.arrayBufferToBase64(n.response),o="data:"+e+";base64,"+t;return o})}function c(n){var e=n.id,t=_.get(n,"c8y_IsBinary.length"),i=o.url([u,e,"binaries"].join("/"));return a.download(e,i,t).then(function(n){var e=n.getResponseHeader("Content-Type"),t=n.getResponseHeader("Content-Disposition"),o=new Blob([n.response],{type:e});saveAs(o,a.getFilenameFromContentDisposition(t))})}function s(n,e){var t=e.id,i=o.url([u,t,"binaries"].join("/"));return a.upload(n,{url:i})}function l(n){return!(!n||!n.c8y_IsBinary)}function v(n){return!_.isUndefined(_.get(n,"c8y_IsBinary.length"))}var u="event/events",y={downloadAsDataUri:r,downloadAndSaveAs:c,doesContainBinary:l,upload:s,canDownload:v};return y}n.$inject=["$q","$http","$upload","c8yBase","c8yAuth","c8yBinaryCommon"],angular.module("c8y.eventsBinary").factory("eventsBinaryService",n)}(),function(){"use strict";function n(n){var e;e='<div class="col col-12">\n  <div ng-if="vm.checkControlAvailable(\'download\')" class="form-group">\n    <button class="btn btn-primary btn-xs" ng-click="vm.download()"><i c8y-icon="download"></i><span translate>Download</span></button>\n  </div>\n  <div ng-if="vm.checkControlAvailable(\'upload\')" class="form-group">\n    <input type="file" c8y-on-change="vm.onNewImageSelected(event)"/>\n    <button class="btn btn-primary btn-xs" ng-click="vm.upload()"><i c8y-icon="upload"></i><span translate>Upload</span></button>\n  </div>\n</div>\n',n.put("core_eventsBinary/components/eventBinaryActions/eventBinaryActions.html",e),n.put("/apps/core/eventsBinary/components/eventBinaryActions/eventBinaryActions.html",e),e='<div class="col col-12" ng-if="vm.dataUri">\n    <img ng-src="{{vm.dataUri}}" style="max-width:100%">\n</div>\n',n.put("core_eventsBinary/components/eventBinaryPreview/eventBinaryPreview.html",e),n.put("/apps/core/eventsBinary/components/eventBinaryPreview/eventBinaryPreview.html",e)}angular.module("c8y.eventsBinary").run(["$templateCache",n])}();